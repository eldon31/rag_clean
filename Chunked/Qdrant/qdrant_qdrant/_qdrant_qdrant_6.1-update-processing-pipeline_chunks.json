[
  {
    "text": "# Update Processing and Optimization  Relevant source files  - [lib/collection/src/collection\\_manager/collection\\_updater.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/collection_manager/collection_updater.rs) - [lib/collection/src/shards/local\\_shard/mod.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/mod.rs) - [lib/collection/src/shards/local\\_shard/scroll.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/scroll.rs) - [lib/collection/src/shards/local\\_shard/snapshot.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/snapshot.rs) - [lib/collection/src/shards/local\\_shard/snapshot\\_tests.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/snapshot_tests.rs) - [lib/collection/src/update\\_handler.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs)  This page covers Qdrant's update processing pipeline and segment optimization system. Update processing handles the ingestion and application of point operations (inserts, updates, deletes) to collection segments, while optimization manages background maintenance tasks that rebuild and consolidate segments for better performance. For information about collection lifecycle management and configuration, see [Collection Management](qdrant/qdrant/5-search-and-query-processing.md). For details about snapshot creation and recovery mechanisms, see [Snapshots and Recovery](qdrant/qdrant/5.2-filtering-and-scoring.md).",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0000",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 0,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Update Processing and Optimization"
      ],
      "heading_text": "Update Processing and Optimization",
      "token_count": 386,
      "char_count": 1590,
      "start_char": 3051,
      "end_char": 4641,
      "semantic_score": 0.6,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5372285714285715,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "list_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.389759",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 386,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Update Processing and Optimization",
      "chunk_hash": "80f30e2ea5a53d49",
      "content_digest": "80f30e2ea5a53d49",
      "chunk_length": 1590,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "collection",
          "qdrant",
          "lib",
          "src",
          "and",
          "shards",
          "local",
          "shard",
          "https",
          "github",
          "com",
          "blob",
          "48203e41",
          "update",
          "snapshot",
          "processing",
          "optimization",
          "for",
          "manager",
          "updater"
        ],
        "term_weights": [
          {
            "term": "collection",
            "tf": 19,
            "weight": 0.093137
          },
          {
            "term": "qdrant",
            "tf": 17,
            "weight": 0.083333
          },
          {
            "term": "lib",
            "tf": 12,
            "weight": 0.058824
          },
          {
            "term": "src",
            "tf": 12,
            "weight": 0.058824
          },
          {
            "term": "and",
            "tf": 9,
            "weight": 0.044118
          },
          {
            "term": "shards",
            "tf": 8,
            "weight": 0.039216
          },
          {
            "term": "local",
            "tf": 8,
            "weight": 0.039216
          },
          {
            "term": "shard",
            "tf": 8,
            "weight": 0.039216
          },
          {
            "term": "https",
            "tf": 6,
            "weight": 0.029412
          },
          {
            "term": "github",
            "tf": 6,
            "weight": 0.029412
          },
          {
            "term": "com",
            "tf": 6,
            "weight": 0.029412
          },
          {
            "term": "blob",
            "tf": 6,
            "weight": 0.029412
          },
          {
            "term": "48203e41",
            "tf": 6,
            "weight": 0.029412
          },
          {
            "term": "update",
            "tf": 5,
            "weight": 0.02451
          },
          {
            "term": "snapshot",
            "tf": 5,
            "weight": 0.02451
          },
          {
            "term": "processing",
            "tf": 4,
            "weight": 0.019608
          },
          {
            "term": "optimization",
            "tf": 3,
            "weight": 0.014706
          },
          {
            "term": "for",
            "tf": 3,
            "weight": 0.014706
          },
          {
            "term": "manager",
            "tf": 2,
            "weight": 0.009804
          },
          {
            "term": "updater",
            "tf": 2,
            "weight": 0.009804
          }
        ],
        "unique_terms": 68,
        "total_terms": 204
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Update Processing and Optimization",
        "and",
        "collection",
        "github",
        "https",
        "lib",
        "local",
        "qdrant",
        "shard",
        "shards",
        "src"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.6,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5372285714285715,
      "overall": 0.6790761904761905
    }
  },
  {
    "text": "## Overview  Qdrant's update processing and optimization system operates through three main worker processes managed by the `UpdateHandler`:  - **Update Worker**: Processes incoming point operations and applies them to segments - **Optimizer Worker**: Monitors segment conditions and launches optimization tasks - **Flush Worker**: Periodically flushes segment data to disk and manages WAL cleanup  The system uses a copy-on-write approach during optimization, allowing reads and writes to continue while segments are being rebuilt in the background.",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0001",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 1,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Overview"
      ],
      "heading_text": "Overview",
      "token_count": 97,
      "char_count": 550,
      "start_char": 4644,
      "end_char": 5194,
      "semantic_score": 0.8,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.522,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "list_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.390944",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 97,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Overview",
      "chunk_hash": "4d15317e52901929",
      "content_digest": "4d15317e52901929",
      "chunk_length": 550,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "and",
          "worker",
          "optimization",
          "the",
          "update",
          "system",
          "processes",
          "segments",
          "segment",
          "overview",
          "qdrant",
          "processing",
          "operates",
          "through",
          "three",
          "main",
          "managed",
          "updatehandler",
          "incoming",
          "point"
        ],
        "term_weights": [
          {
            "term": "and",
            "tf": 5,
            "weight": 0.075758
          },
          {
            "term": "worker",
            "tf": 4,
            "weight": 0.060606
          },
          {
            "term": "optimization",
            "tf": 3,
            "weight": 0.045455
          },
          {
            "term": "the",
            "tf": 3,
            "weight": 0.045455
          },
          {
            "term": "update",
            "tf": 2,
            "weight": 0.030303
          },
          {
            "term": "system",
            "tf": 2,
            "weight": 0.030303
          },
          {
            "term": "processes",
            "tf": 2,
            "weight": 0.030303
          },
          {
            "term": "segments",
            "tf": 2,
            "weight": 0.030303
          },
          {
            "term": "segment",
            "tf": 2,
            "weight": 0.030303
          },
          {
            "term": "overview",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "qdrant",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "processing",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "operates",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "through",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "three",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "main",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "managed",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "updatehandler",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "incoming",
            "tf": 1,
            "weight": 0.015152
          },
          {
            "term": "point",
            "tf": 1,
            "weight": 0.015152
          }
        ],
        "unique_terms": 50,
        "total_terms": 66
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Overview",
        "and",
        "optimization",
        "overview",
        "processes",
        "segment",
        "segments",
        "system",
        "the",
        "update",
        "worker"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.8,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.522,
      "overall": 0.7406666666666667
    }
  },
  {
    "text": "## Update Handler Architecture  The `UpdateHandler` serves as the central coordinator for all update and optimization operations within a collection shard. ``` ``` Sources: [lib/collection/src/update\\_handler.rs87-129](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs#L87-L129) [lib/collection/src/update\\_handler.rs172-205](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs#L172-L205)",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0002",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 2,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Update Handler Architecture"
      ],
      "heading_text": "Update Handler Architecture",
      "token_count": 114,
      "char_count": 454,
      "start_char": 5196,
      "end_char": 5650,
      "semantic_score": 0.6,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5553846153846154,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.392805",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 114,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Update Handler Architecture",
      "chunk_hash": "7d9d7bb37c99aec6",
      "content_digest": "7d9d7bb37c99aec6",
      "chunk_length": 454,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "update",
          "handler",
          "collection",
          "lib",
          "src",
          "qdrant",
          "the",
          "https",
          "github",
          "com",
          "blob",
          "48203e41",
          "architecture",
          "updatehandler",
          "serves",
          "central",
          "coordinator",
          "for",
          "all",
          "and"
        ],
        "term_weights": [
          {
            "term": "update",
            "tf": 6,
            "weight": 0.098361
          },
          {
            "term": "handler",
            "tf": 5,
            "weight": 0.081967
          },
          {
            "term": "collection",
            "tf": 5,
            "weight": 0.081967
          },
          {
            "term": "lib",
            "tf": 4,
            "weight": 0.065574
          },
          {
            "term": "src",
            "tf": 4,
            "weight": 0.065574
          },
          {
            "term": "qdrant",
            "tf": 4,
            "weight": 0.065574
          },
          {
            "term": "the",
            "tf": 2,
            "weight": 0.032787
          },
          {
            "term": "https",
            "tf": 2,
            "weight": 0.032787
          },
          {
            "term": "github",
            "tf": 2,
            "weight": 0.032787
          },
          {
            "term": "com",
            "tf": 2,
            "weight": 0.032787
          },
          {
            "term": "blob",
            "tf": 2,
            "weight": 0.032787
          },
          {
            "term": "48203e41",
            "tf": 2,
            "weight": 0.032787
          },
          {
            "term": "architecture",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "updatehandler",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "serves",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "central",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "coordinator",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "for",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "all",
            "tf": 1,
            "weight": 0.016393
          },
          {
            "term": "and",
            "tf": 1,
            "weight": 0.016393
          }
        ],
        "unique_terms": 33,
        "total_terms": 61
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Update Handler Architecture",
        "collection",
        "com",
        "github",
        "handler",
        "https",
        "lib",
        "qdrant",
        "src",
        "the",
        "update"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.6,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5553846153846154,
      "overall": 0.6851282051282052
    }
  },
  {
    "text": "## Update Processing Pipeline",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0003",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 3,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Update Processing Pipeline"
      ],
      "heading_text": "Update Processing Pipeline",
      "token_count": 4,
      "char_count": 29,
      "start_char": 5654,
      "end_char": 5683,
      "semantic_score": 0.8,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.59,
      "chunking_strategy": "hierarchical_balanced_semchunk",
      "content_type": "prose_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.393269",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 4,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Update Processing Pipeline",
      "chunk_hash": "48e8c11fb97adf8e",
      "content_digest": "48e8c11fb97adf8e",
      "chunk_length": 29,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "update",
          "processing",
          "pipeline"
        ],
        "term_weights": [
          {
            "term": "update",
            "tf": 1,
            "weight": 0.333333
          },
          {
            "term": "processing",
            "tf": 1,
            "weight": 0.333333
          },
          {
            "term": "pipeline",
            "tf": 1,
            "weight": 0.333333
          }
        ],
        "unique_terms": 3,
        "total_terms": 3
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Update Processing Pipeline",
        "pipeline",
        "processing",
        "update"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.8,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.59,
      "overall": 0.7633333333333333
    }
  },
  {
    "text": "## Optimization System",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0006",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 6,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Optimization System"
      ],
      "heading_text": "Optimization System",
      "token_count": 3,
      "char_count": 22,
      "start_char": 7106,
      "end_char": 7128,
      "semantic_score": 0.8,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.59,
      "chunking_strategy": "hierarchical_balanced_semchunk",
      "content_type": "prose_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.400344",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 3,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Optimization System",
      "chunk_hash": "e8d27688087a9d26",
      "content_digest": "e8d27688087a9d26",
      "chunk_length": 22,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "optimization",
          "system"
        ],
        "term_weights": [
          {
            "term": "optimization",
            "tf": 1,
            "weight": 0.5
          },
          {
            "term": "system",
            "tf": 1,
            "weight": 0.5
          }
        ],
        "unique_terms": 2,
        "total_terms": 2
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Optimization System",
        "optimization",
        "system"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.8,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.59,
      "overall": 0.7633333333333333
    }
  },
  {
    "text": "#### Config Mismatch Optimizer\n\nRebuilds segments when collection configuration changes require different segment parameters:\n\nSources: [lib/collection/src/collection\\_manager/optimizers/config\\_mismatch\\_optimizer.rs104-215](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/collection_manager/optimizers/config_mismatch_optimizer.rs#L104-L215)",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0011",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 11,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Config Mismatch Optimizer"
      ],
      "heading_text": "Config Mismatch Optimizer",
      "token_count": 82,
      "char_count": 361,
      "start_char": 8196,
      "end_char": 8557,
      "semantic_score": 0.7,
      "structural_score": 0.7,
      "retrieval_quality": 0.59,
      "chunking_strategy": "hierarchical_balanced_semchunk",
      "content_type": "prose_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.406532",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 82,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Config Mismatch Optimizer",
      "chunk_hash": "6d020c0cf5bb838b",
      "content_digest": "6d020c0cf5bb838b",
      "chunk_length": 361,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "collection",
          "config",
          "mismatch",
          "optimizer",
          "lib",
          "src",
          "manager",
          "optimizers",
          "qdrant",
          "rebuilds",
          "segments",
          "when",
          "configuration",
          "changes",
          "require",
          "different",
          "segment",
          "parameters",
          "sources",
          "rs104"
        ],
        "term_weights": [
          {
            "term": "collection",
            "tf": 5,
            "weight": 0.116279
          },
          {
            "term": "config",
            "tf": 3,
            "weight": 0.069767
          },
          {
            "term": "mismatch",
            "tf": 3,
            "weight": 0.069767
          },
          {
            "term": "optimizer",
            "tf": 3,
            "weight": 0.069767
          },
          {
            "term": "lib",
            "tf": 2,
            "weight": 0.046512
          },
          {
            "term": "src",
            "tf": 2,
            "weight": 0.046512
          },
          {
            "term": "manager",
            "tf": 2,
            "weight": 0.046512
          },
          {
            "term": "optimizers",
            "tf": 2,
            "weight": 0.046512
          },
          {
            "term": "qdrant",
            "tf": 2,
            "weight": 0.046512
          },
          {
            "term": "rebuilds",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "segments",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "when",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "configuration",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "changes",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "require",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "different",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "segment",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "parameters",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "sources",
            "tf": 1,
            "weight": 0.023256
          },
          {
            "term": "rs104",
            "tf": 1,
            "weight": 0.023256
          }
        ],
        "unique_terms": 28,
        "total_terms": 43
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Config Mismatch Optimizer",
        "collection",
        "config",
        "lib",
        "manager",
        "mismatch",
        "optimizer",
        "optimizers",
        "qdrant",
        "rebuilds",
        "src"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.7,
      "retrieval_quality": 0.59,
      "overall": 0.6633333333333332
    }
  },
  {
    "text": "### Optimization Process  The optimization process uses proxy segments to maintain availability during rebuilding: ``` ``` Sources: [lib/collection/src/collection\\_manager/optimizers/segment\\_optimizer.rs576-685](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/collection_manager/optimizers/segment_optimizer.rs#L576-L685)",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0012",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 12,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Optimization Process"
      ],
      "heading_text": "Optimization Process",
      "token_count": 77,
      "char_count": 340,
      "start_char": 8559,
      "end_char": 8899,
      "semantic_score": 0.7,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.54,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.408082",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 77,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Optimization Process",
      "chunk_hash": "112d47702e998349",
      "content_digest": "112d47702e998349",
      "chunk_length": 340,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "collection",
          "optimization",
          "process",
          "lib",
          "src",
          "manager",
          "optimizers",
          "segment",
          "optimizer",
          "qdrant",
          "the",
          "uses",
          "proxy",
          "segments",
          "maintain",
          "availability",
          "during",
          "rebuilding",
          "sources",
          "rs576"
        ],
        "term_weights": [
          {
            "term": "collection",
            "tf": 4,
            "weight": 0.1
          },
          {
            "term": "optimization",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "process",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "lib",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "src",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "manager",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "optimizers",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "segment",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "optimizer",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "qdrant",
            "tf": 2,
            "weight": 0.05
          },
          {
            "term": "the",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "uses",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "proxy",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "segments",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "maintain",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "availability",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "during",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "rebuilding",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "sources",
            "tf": 1,
            "weight": 0.025
          },
          {
            "term": "rs576",
            "tf": 1,
            "weight": 0.025
          }
        ],
        "unique_terms": 28,
        "total_terms": 40
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Optimization Process",
        "collection",
        "lib",
        "manager",
        "optimization",
        "optimizer",
        "optimizers",
        "process",
        "qdrant",
        "segment",
        "src"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.54,
      "overall": 0.7133333333333333
    }
  },
  {
    "text": "## Segment Builder  The `SegmentBuilder` constructs optimized segments by combining data from multiple source segments: ``` ``` Key building steps include:  1. **Data Copying**: Transfer vectors and payloads from source segments 2. **Index Building**: Create HNSW or other indexes based on configuration 3. **Quantization**: Apply vector compression if configured 4. **Defragmentation**: Reorganize data for better locality  Sources: [lib/segment/src/segment\\_constructor/segment\\_builder.rs459-685](https://github.com/qdrant/qdrant/blob/48203e41/lib/segment/src/segment_constructor/segment_builder.rs#L459-L685)",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0013",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 13,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Segment Builder"
      ],
      "heading_text": "Segment Builder",
      "token_count": 141,
      "char_count": 612,
      "start_char": 8903,
      "end_char": 9515,
      "semantic_score": 0.7,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.7641379310344828,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.411234",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 141,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Segment Builder",
      "chunk_hash": "18d0745351c45c7a",
      "content_digest": "18d0745351c45c7a",
      "chunk_length": 612,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "segment",
          "builder",
          "segments",
          "data",
          "from",
          "source",
          "building",
          "lib",
          "src",
          "constructor",
          "qdrant",
          "the",
          "segmentbuilder",
          "constructs",
          "optimized",
          "combining",
          "multiple",
          "key",
          "steps",
          "include"
        ],
        "term_weights": [
          {
            "term": "segment",
            "tf": 7,
            "weight": 0.098592
          },
          {
            "term": "builder",
            "tf": 3,
            "weight": 0.042254
          },
          {
            "term": "segments",
            "tf": 3,
            "weight": 0.042254
          },
          {
            "term": "data",
            "tf": 3,
            "weight": 0.042254
          },
          {
            "term": "from",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "source",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "building",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "lib",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "src",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "constructor",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "qdrant",
            "tf": 2,
            "weight": 0.028169
          },
          {
            "term": "the",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "segmentbuilder",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "constructs",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "optimized",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "combining",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "multiple",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "key",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "steps",
            "tf": 1,
            "weight": 0.014085
          },
          {
            "term": "include",
            "tf": 1,
            "weight": 0.014085
          }
        ],
        "unique_terms": 52,
        "total_terms": 71
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Segment Builder",
        "builder",
        "building",
        "constructor",
        "data",
        "from",
        "lib",
        "segment",
        "segments",
        "source",
        "src"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.7641379310344828,
      "overall": 0.7880459770114943
    }
  },
  {
    "text": "### CPU and IO Budgeting  Optimization tasks use resource permits to control concurrent operations: ``` ``` Sources: [lib/collection/src/update\\_handler.rs270-326](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs#L270-L326) [lib/collection/src/update\\_handler.rs521-526](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs#L521-L526)",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0015",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 15,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "CPU and IO Budgeting"
      ],
      "heading_text": "CPU and IO Budgeting",
      "token_count": 105,
      "char_count": 400,
      "start_char": 9543,
      "end_char": 9943,
      "semantic_score": 0.6,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5742105263157895,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.426904",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 105,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "CPU and IO Budgeting",
      "chunk_hash": "40e9ae446618fc95",
      "content_digest": "40e9ae446618fc95",
      "chunk_length": 400,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "lib",
          "collection",
          "src",
          "update",
          "handler",
          "qdrant",
          "https",
          "github",
          "com",
          "blob",
          "48203e41",
          "cpu",
          "and",
          "budgeting",
          "optimization",
          "tasks",
          "use",
          "resource",
          "permits",
          "control"
        ],
        "term_weights": [
          {
            "term": "lib",
            "tf": 4,
            "weight": 0.074074
          },
          {
            "term": "collection",
            "tf": 4,
            "weight": 0.074074
          },
          {
            "term": "src",
            "tf": 4,
            "weight": 0.074074
          },
          {
            "term": "update",
            "tf": 4,
            "weight": 0.074074
          },
          {
            "term": "handler",
            "tf": 4,
            "weight": 0.074074
          },
          {
            "term": "qdrant",
            "tf": 4,
            "weight": 0.074074
          },
          {
            "term": "https",
            "tf": 2,
            "weight": 0.037037
          },
          {
            "term": "github",
            "tf": 2,
            "weight": 0.037037
          },
          {
            "term": "com",
            "tf": 2,
            "weight": 0.037037
          },
          {
            "term": "blob",
            "tf": 2,
            "weight": 0.037037
          },
          {
            "term": "48203e41",
            "tf": 2,
            "weight": 0.037037
          },
          {
            "term": "cpu",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "and",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "budgeting",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "optimization",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "tasks",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "use",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "resource",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "permits",
            "tf": 1,
            "weight": 0.018519
          },
          {
            "term": "control",
            "tf": 1,
            "weight": 0.018519
          }
        ],
        "unique_terms": 31,
        "total_terms": 54
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "CPU and IO Budgeting",
        "blob",
        "collection",
        "com",
        "github",
        "handler",
        "https",
        "lib",
        "qdrant",
        "src",
        "update"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.6,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5742105263157895,
      "overall": 0.6914035087719298
    }
  },
  {
    "text": "### Failed Operation Recovery  The system maintains tracking of failed operations and attempts recovery: ``` ``` Sources: [lib/collection/src/update\\_handler.rs247-265](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs#L247-L265)",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0019",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 19,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Failed Operation Recovery"
      ],
      "heading_text": "Failed Operation Recovery",
      "token_count": 62,
      "char_count": 263,
      "start_char": 11359,
      "end_char": 11622,
      "semantic_score": 0.7,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5566666666666666,
      "chunking_strategy": "hierarchical_balanced_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.432014",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 62,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Failed Operation Recovery",
      "chunk_hash": "8cd4860728dcc4e0",
      "content_digest": "8cd4860728dcc4e0",
      "chunk_length": 263,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "failed",
          "recovery",
          "lib",
          "collection",
          "src",
          "update",
          "handler",
          "qdrant",
          "operation",
          "the",
          "system",
          "maintains",
          "tracking",
          "operations",
          "and",
          "attempts",
          "sources",
          "rs247",
          "265",
          "https"
        ],
        "term_weights": [
          {
            "term": "failed",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "recovery",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "lib",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "collection",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "src",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "update",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "handler",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "qdrant",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "operation",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "the",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "system",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "maintains",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "tracking",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "operations",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "and",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "attempts",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "sources",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "rs247",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "265",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "https",
            "tf": 1,
            "weight": 0.029412
          }
        ],
        "unique_terms": 26,
        "total_terms": 34
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Failed Operation Recovery",
        "collection",
        "failed",
        "handler",
        "lib",
        "operation",
        "qdrant",
        "recovery",
        "src",
        "the",
        "update"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5566666666666666,
      "overall": 0.7188888888888888
    }
  },
  {
    "text": "### Optimization Cancellation\n\nOptimizations can be cancelled gracefully, restoring original segments:\n\nSources: [lib/collection/src/update\\_handler.rs381-396](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs#L381-L396) [lib/collection/src/collection\\_manager/optimizers/segment\\_optimizer.rs341-396](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/collection_manager/optimizers/segment_optimizer.rs#L341-L396)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh",
    "metadata": {
      "chunk_id": "47d350d9a1e9-0020",
      "source_file": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "file_extension": ".md",
      "chunk_index": 20,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Optimization Cancellation"
      ],
      "heading_text": "Optimization Cancellation",
      "token_count": 128,
      "char_count": 515,
      "start_char": 11626,
      "end_char": 12141,
      "semantic_score": 0.7,
      "structural_score": 0.7,
      "retrieval_quality": 0.5763636363636364,
      "chunking_strategy": "hierarchical_balanced_semchunk",
      "content_type": "prose_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:46.432817",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 128,
      "document_id": "47d350d9a1e9",
      "document_name": "_qdrant_qdrant_6.1-update-processing-pipeline",
      "source_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_filename": "_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "source_directory": "Docs\\Qdrant\\qdrant_qdrant",
      "relative_path": "Docs\\Qdrant\\qdrant_qdrant\\_qdrant_qdrant_6.1-update-processing-pipeline.md",
      "hierarchy_path": "Optimization Cancellation",
      "chunk_hash": "0246c61eeed5c7b4",
      "content_digest": "0246c61eeed5c7b4",
      "chunk_length": 515,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "collection",
          "lib",
          "src",
          "qdrant",
          "update",
          "handler",
          "396",
          "https",
          "github",
          "com",
          "blob",
          "48203e41",
          "l396",
          "manager",
          "optimizers",
          "segment",
          "optimizer",
          "refresh",
          "optimization",
          "cancellation"
        ],
        "term_weights": [
          {
            "term": "collection",
            "tf": 6,
            "weight": 0.092308
          },
          {
            "term": "lib",
            "tf": 4,
            "weight": 0.061538
          },
          {
            "term": "src",
            "tf": 4,
            "weight": 0.061538
          },
          {
            "term": "qdrant",
            "tf": 4,
            "weight": 0.061538
          },
          {
            "term": "update",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "handler",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "396",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "https",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "github",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "com",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "blob",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "48203e41",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "l396",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "manager",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "optimizers",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "segment",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "optimizer",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "refresh",
            "tf": 2,
            "weight": 0.030769
          },
          {
            "term": "optimization",
            "tf": 1,
            "weight": 0.015385
          },
          {
            "term": "cancellation",
            "tf": 1,
            "weight": 0.015385
          }
        ],
        "unique_terms": 37,
        "total_terms": 65
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "396",
        "Optimization Cancellation",
        "collection",
        "com",
        "github",
        "handler",
        "https",
        "lib",
        "qdrant",
        "src",
        "update"
      ],
      "collection_name": "Qdrant"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.7,
      "retrieval_quality": 0.5763636363636364,
      "overall": 0.6587878787878788
    }
  }
]