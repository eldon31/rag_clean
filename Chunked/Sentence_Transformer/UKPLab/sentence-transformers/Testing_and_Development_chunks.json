[
  {
    "text": "## Test Framework Overview  The sentence-transformers library uses a comprehensive pytest-based testing framework that validates functionality across all three core model types: SentenceTransformer, SparseEncoder, and CrossEncoder. ```mermaid graph TB     subgraph \"Test Structure\"         TestRoot[\"tests/\"]         MainTests[\"tests/*.py\"]         CrossTests[\"tests/cross_encoder/\"]         SparseTests[\"tests/sparse_encoder/\"]     end          subgraph \"Test Categories\"         UnitTests[\"Unit Tests\"]         IntegrationTests[\"Integration Tests\"]         SlowTests[\"Slow Tests (@pytest.mark.slow)\"]         ModelTests[\"Pretrained Model Tests\"]         TrainingTests[\"Training Tests\"]     end          subgraph \"Test Configuration\"         MainConf[\"tests/conftest.py\"]         CrossConf[\"tests/cross_encoder/conftest.py\"]         SparseConf[\"tests/sparse_encoder/conftest.py\"]     end          TestRoot --> MainTests     TestRoot --> CrossTests     TestRoot --> SparseTests          MainConf --> UnitTests     MainConf --> IntegrationTests     CrossConf --> CrossTests     SparseConf --> SparseTests          SlowTests --> ModelTests     SlowTests --> TrainingTests ``` Sources: [tests/conftest.py:1-115](), [tests/cross_encoder/conftest.py:1-23](), [tests/sparse_encoder/conftest.py:1-46]()",
    "metadata": {
      "chunk_id": "d5021e95536b-0000",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "filename": "Testing_and_Development.md",
      "file_extension": ".md",
      "chunk_index": 0,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Test Framework Overview"
      ],
      "heading_text": "Test Framework Overview",
      "token_count": 281,
      "char_count": 1295,
      "start_char": 368,
      "end_char": 1663,
      "semantic_score": 0.7999999999999999,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5084782608695652,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:50.598109",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 281,
      "document_id": "d5021e95536b",
      "document_name": "Testing_and_Development",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "source_filename": "Testing_and_Development.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "hierarchy_path": "Test Framework Overview",
      "chunk_hash": "017a8d5dfd1358cd",
      "content_digest": "017a8d5dfd1358cd",
      "chunk_length": 1295,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "tests",
          "encoder",
          "conftest",
          "test",
          "testroot",
          "subgraph",
          "crosstests",
          "cross",
          "sparsetests",
          "sparse",
          "end",
          "slowtests",
          "mainconf",
          "framework",
          "pytest",
          "model",
          "maintests",
          "unittests",
          "integrationtests",
          "slow"
        ],
        "term_weights": [
          {
            "term": "tests",
            "tf": 15,
            "weight": 0.131579
          },
          {
            "term": "encoder",
            "tf": 6,
            "weight": 0.052632
          },
          {
            "term": "conftest",
            "tf": 6,
            "weight": 0.052632
          },
          {
            "term": "test",
            "tf": 4,
            "weight": 0.035088
          },
          {
            "term": "testroot",
            "tf": 4,
            "weight": 0.035088
          },
          {
            "term": "subgraph",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "crosstests",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "cross",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "sparsetests",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "sparse",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "end",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "slowtests",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "mainconf",
            "tf": 3,
            "weight": 0.026316
          },
          {
            "term": "framework",
            "tf": 2,
            "weight": 0.017544
          },
          {
            "term": "pytest",
            "tf": 2,
            "weight": 0.017544
          },
          {
            "term": "model",
            "tf": 2,
            "weight": 0.017544
          },
          {
            "term": "maintests",
            "tf": 2,
            "weight": 0.017544
          },
          {
            "term": "unittests",
            "tf": 2,
            "weight": 0.017544
          },
          {
            "term": "integrationtests",
            "tf": 2,
            "weight": 0.017544
          },
          {
            "term": "slow",
            "tf": 2,
            "weight": 0.017544
          }
        ],
        "unique_terms": 57,
        "total_terms": 114
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Test Framework Overview",
        "conftest",
        "cross",
        "crosstests",
        "encoder",
        "sparse",
        "sparsetests",
        "subgraph",
        "test",
        "testroot",
        "tests"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.7999999999999999,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5084782608695652,
      "overall": 0.736159420289855
    }
  },
  {
    "text": "## Test Configuration and Fixtures\n\nThe testing framework uses pytest fixtures to manage test dependencies and ensure proper isolation between tests.",
    "metadata": {
      "chunk_id": "d5021e95536b-0001",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "filename": "Testing_and_Development.md",
      "file_extension": ".md",
      "chunk_index": 1,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Test Configuration and Fixtures"
      ],
      "heading_text": "Test Configuration and Fixtures",
      "token_count": 24,
      "char_count": 149,
      "start_char": 1667,
      "end_char": 1816,
      "semantic_score": 0.8,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5471428571428572,
      "chunking_strategy": "hybrid_adaptive_semchunk",
      "content_type": "prose_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:50.599004",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 24,
      "document_id": "d5021e95536b",
      "document_name": "Testing_and_Development",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "source_filename": "Testing_and_Development.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "hierarchy_path": "Test Configuration and Fixtures",
      "chunk_hash": "595e57da403b032c",
      "content_digest": "595e57da403b032c",
      "chunk_length": 149,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "test",
          "and",
          "fixtures",
          "configuration",
          "the",
          "testing",
          "framework",
          "uses",
          "pytest",
          "manage",
          "dependencies",
          "ensure",
          "proper",
          "isolation",
          "between",
          "tests"
        ],
        "term_weights": [
          {
            "term": "test",
            "tf": 2,
            "weight": 0.105263
          },
          {
            "term": "and",
            "tf": 2,
            "weight": 0.105263
          },
          {
            "term": "fixtures",
            "tf": 2,
            "weight": 0.105263
          },
          {
            "term": "configuration",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "the",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "testing",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "framework",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "uses",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "pytest",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "manage",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "dependencies",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "ensure",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "proper",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "isolation",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "between",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "tests",
            "tf": 1,
            "weight": 0.052632
          }
        ],
        "unique_terms": 16,
        "total_terms": 19
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Test Configuration and Fixtures",
        "and",
        "configuration",
        "fixtures",
        "framework",
        "manage",
        "pytest",
        "test",
        "testing",
        "the",
        "uses"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.8,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5471428571428572,
      "overall": 0.7490476190476191
    }
  },
  {
    "text": "### Model Loading Strategy ```mermaid graph LR     subgraph \"Session Fixtures\"         SessionModel[\"_stsb_bert_tiny_model<br/>(session scope)\"]         SessionSparse[\"_splade_bert_tiny_model<br/>(session scope)\"]     end          subgraph \"Function Fixtures\"         FuncModel[\"stsb_bert_tiny_model<br/>(function scope)\"]         FuncSparse[\"splade_bert_tiny_model<br/>(function scope)\"]     end          SessionModel --> |\"deepcopy()\"| FuncModel     SessionSparse --> |\"deepcopy()\"| FuncSparse          FuncModel --> TestCase1[\"test_encode()\"]     FuncModel --> TestCase2[\"test_similarity()\"]     FuncSparse --> TestCase3[\"test_sparse_encode()\"] ``` The testing framework uses session-scoped fixtures to load models once per test session, then creates function-scoped copies using `deepcopy()` to ensure test isolation without the overhead of repeatedly loading models. Sources: [tests/conftest.py:19-40](), [tests/sparse_encoder/conftest.py:10-31](), [tests/cross_encoder/conftest.py:15-22]()",
    "metadata": {
      "chunk_id": "d5021e95536b-0003",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "filename": "Testing_and_Development.md",
      "file_extension": ".md",
      "chunk_index": 3,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Model Loading Strategy"
      ],
      "heading_text": "Model Loading Strategy",
      "token_count": 242,
      "char_count": 995,
      "start_char": 2372,
      "end_char": 3367,
      "semantic_score": 0.7999999999999999,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.518,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:50.602970",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 242,
      "document_id": "d5021e95536b",
      "document_name": "Testing_and_Development",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "source_filename": "Testing_and_Development.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "hierarchy_path": "Model Loading Strategy",
      "chunk_hash": "6dba682f26c33231",
      "content_digest": "6dba682f26c33231",
      "chunk_length": 995,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "model",
          "session",
          "test",
          "bert",
          "tiny",
          "scope",
          "function",
          "funcmodel",
          "fixtures",
          "funcsparse",
          "deepcopy",
          "tests",
          "conftest",
          "loading",
          "subgraph",
          "sessionmodel",
          "stsb",
          "sessionsparse",
          "splade",
          "end"
        ],
        "term_weights": [
          {
            "term": "model",
            "tf": 5,
            "weight": 0.05
          },
          {
            "term": "session",
            "tf": 5,
            "weight": 0.05
          },
          {
            "term": "test",
            "tf": 5,
            "weight": 0.05
          },
          {
            "term": "bert",
            "tf": 4,
            "weight": 0.04
          },
          {
            "term": "tiny",
            "tf": 4,
            "weight": 0.04
          },
          {
            "term": "scope",
            "tf": 4,
            "weight": 0.04
          },
          {
            "term": "function",
            "tf": 4,
            "weight": 0.04
          },
          {
            "term": "funcmodel",
            "tf": 4,
            "weight": 0.04
          },
          {
            "term": "fixtures",
            "tf": 3,
            "weight": 0.03
          },
          {
            "term": "funcsparse",
            "tf": 3,
            "weight": 0.03
          },
          {
            "term": "deepcopy",
            "tf": 3,
            "weight": 0.03
          },
          {
            "term": "tests",
            "tf": 3,
            "weight": 0.03
          },
          {
            "term": "conftest",
            "tf": 3,
            "weight": 0.03
          },
          {
            "term": "loading",
            "tf": 2,
            "weight": 0.02
          },
          {
            "term": "subgraph",
            "tf": 2,
            "weight": 0.02
          },
          {
            "term": "sessionmodel",
            "tf": 2,
            "weight": 0.02
          },
          {
            "term": "stsb",
            "tf": 2,
            "weight": 0.02
          },
          {
            "term": "sessionsparse",
            "tf": 2,
            "weight": 0.02
          },
          {
            "term": "splade",
            "tf": 2,
            "weight": 0.02
          },
          {
            "term": "end",
            "tf": 2,
            "weight": 0.02
          }
        ],
        "unique_terms": 50,
        "total_terms": 100
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Model Loading Strategy",
        "bert",
        "fixtures",
        "funcmodel",
        "funcsparse",
        "function",
        "model",
        "scope",
        "session",
        "test",
        "tiny"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.7999999999999999,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.518,
      "overall": 0.7393333333333333
    }
  },
  {
    "text": "### Performance Validation Tests  The `test_pretrained_stsb.py` module validates that pretrained models maintain expected performance on the STSbenchmark dataset: ```python",
    "metadata": {
      "chunk_id": "d5021e95536b-0005",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "filename": "Testing_and_Development.md",
      "file_extension": ".md",
      "chunk_index": 5,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Performance Validation Tests"
      ],
      "heading_text": "Performance Validation Tests",
      "token_count": 31,
      "char_count": 172,
      "start_char": 3392,
      "end_char": 3564,
      "semantic_score": 0.7,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5584210526315789,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1024,
      "processing_timestamp": "2025-10-20T18:30:50.604333",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 31,
      "document_id": "d5021e95536b",
      "document_name": "Testing_and_Development",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "source_filename": "Testing_and_Development.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Testing_and_Development.md",
      "hierarchy_path": "Performance Validation Tests",
      "chunk_hash": "c2e6b62df803d0a2",
      "content_digest": "c2e6b62df803d0a2",
      "chunk_length": 172,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1024,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "performance",
          "the",
          "pretrained",
          "validation",
          "tests",
          "test",
          "stsb",
          "module",
          "validates",
          "that",
          "models",
          "maintain",
          "expected",
          "stsbenchmark",
          "dataset",
          "python"
        ],
        "term_weights": [
          {
            "term": "performance",
            "tf": 2,
            "weight": 0.105263
          },
          {
            "term": "the",
            "tf": 2,
            "weight": 0.105263
          },
          {
            "term": "pretrained",
            "tf": 2,
            "weight": 0.105263
          },
          {
            "term": "validation",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "tests",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "test",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "stsb",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "module",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "validates",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "that",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "models",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "maintain",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "expected",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "stsbenchmark",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "dataset",
            "tf": 1,
            "weight": 0.052632
          },
          {
            "term": "python",
            "tf": 1,
            "weight": 0.052632
          }
        ],
        "unique_terms": 16,
        "total_terms": 19
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Performance Validation Tests",
        "module",
        "performance",
        "pretrained",
        "stsb",
        "test",
        "tests",
        "that",
        "the",
        "validates",
        "validation"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5584210526315789,
      "overall": 0.7194736842105263
    }
  }
]