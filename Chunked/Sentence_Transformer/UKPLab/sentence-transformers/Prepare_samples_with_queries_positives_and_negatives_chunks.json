[
  {
    "text": "# Prepare queries, corpus, and relevance judgments queries = {\"q1\": \"machine learning definition\"} corpus = {\"d1\": \"ML is AI subset\", \"d2\": \"Weather is sunny\"}   relevant_docs = {\"q1\": {\"d1\"}}  evaluator = InformationRetrievalEvaluator(     queries=queries,     corpus=corpus,      relevant_docs=relevant_docs,     name=\"ir_test\" ) results = evaluator(model) print(f\"MAP@100: {results['ir_test_cosine_map@100']}\") ``` Sources: [sentence_transformers/evaluation/BinaryClassificationEvaluator.py:49-83](), [sentence_transformers/evaluation/RerankingEvaluator.py:48-87](), [sentence_transformers/evaluation/InformationRetrievalEvaluator.py:54-123](), [tests/test_pretrained_stsb.py:74-79]()",
    "metadata": {
      "chunk_id": "0f5b602ef62a-0001",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "file_extension": ".md",
      "chunk_index": 1,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Prepare queries, corpus, and relevance judgments"
      ],
      "heading_text": "Prepare queries, corpus, and relevance judgments",
      "token_count": 180,
      "char_count": 687,
      "start_char": 479,
      "end_char": 1166,
      "semantic_score": 0.7999999999999999,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5517021276595745,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1536,
      "processing_timestamp": "2025-10-20T16:07:46.136380",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 180,
      "document_id": "0f5b602ef62a",
      "document_name": "Prepare_samples_with_queries_positives_and_negatives",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "source_filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "hierarchy_path": "Prepare queries, corpus, and relevance judgments",
      "chunk_hash": "0edac484a40af721",
      "content_digest": "0edac484a40af721",
      "chunk_length": 687,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1536,
      "matryoshka_dimension": 1536,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "queries",
          "corpus",
          "relevant",
          "docs",
          "test",
          "sentence",
          "transformers",
          "evaluation",
          "evaluator",
          "informationretrievalevaluator",
          "results",
          "map",
          "100",
          "prepare",
          "and",
          "relevance",
          "judgments",
          "machine",
          "learning",
          "definition"
        ],
        "term_weights": [
          {
            "term": "queries",
            "tf": 4,
            "weight": 0.070175
          },
          {
            "term": "corpus",
            "tf": 4,
            "weight": 0.070175
          },
          {
            "term": "relevant",
            "tf": 3,
            "weight": 0.052632
          },
          {
            "term": "docs",
            "tf": 3,
            "weight": 0.052632
          },
          {
            "term": "test",
            "tf": 3,
            "weight": 0.052632
          },
          {
            "term": "sentence",
            "tf": 3,
            "weight": 0.052632
          },
          {
            "term": "transformers",
            "tf": 3,
            "weight": 0.052632
          },
          {
            "term": "evaluation",
            "tf": 3,
            "weight": 0.052632
          },
          {
            "term": "evaluator",
            "tf": 2,
            "weight": 0.035088
          },
          {
            "term": "informationretrievalevaluator",
            "tf": 2,
            "weight": 0.035088
          },
          {
            "term": "results",
            "tf": 2,
            "weight": 0.035088
          },
          {
            "term": "map",
            "tf": 2,
            "weight": 0.035088
          },
          {
            "term": "100",
            "tf": 2,
            "weight": 0.035088
          },
          {
            "term": "prepare",
            "tf": 1,
            "weight": 0.017544
          },
          {
            "term": "and",
            "tf": 1,
            "weight": 0.017544
          },
          {
            "term": "relevance",
            "tf": 1,
            "weight": 0.017544
          },
          {
            "term": "judgments",
            "tf": 1,
            "weight": 0.017544
          },
          {
            "term": "machine",
            "tf": 1,
            "weight": 0.017544
          },
          {
            "term": "learning",
            "tf": 1,
            "weight": 0.017544
          },
          {
            "term": "definition",
            "tf": 1,
            "weight": 0.017544
          }
        ],
        "unique_terms": 34,
        "total_terms": 57
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Prepare queries, corpus, and relevance judgments",
        "corpus",
        "docs",
        "evaluation",
        "evaluator",
        "informationretrievalevaluator",
        "queries",
        "relevant",
        "sentence",
        "test",
        "transformers"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.7999999999999999,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5517021276595745,
      "overall": 0.7505673758865248
    }
  },
  {
    "text": "# Called automatically during training results = evaluator(model, output_path=\"./results\", epoch=1, steps=100)",
    "metadata": {
      "chunk_id": "0f5b602ef62a-0004",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "file_extension": ".md",
      "chunk_index": 4,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Called automatically during training"
      ],
      "heading_text": "Called automatically during training",
      "token_count": 23,
      "char_count": 110,
      "start_char": 2248,
      "end_char": 2358,
      "semantic_score": 0.6,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.7899999999999999,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1536,
      "processing_timestamp": "2025-10-20T16:07:46.143665",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 23,
      "document_id": "0f5b602ef62a",
      "document_name": "Prepare_samples_with_queries_positives_and_negatives",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "source_filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "hierarchy_path": "Called automatically during training",
      "chunk_hash": "c48c137719facd6b",
      "content_digest": "c48c137719facd6b",
      "chunk_length": 110,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1536,
      "matryoshka_dimension": 1536,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "results",
          "called",
          "automatically",
          "during",
          "training",
          "evaluator",
          "model",
          "output",
          "path",
          "epoch",
          "steps",
          "100"
        ],
        "term_weights": [
          {
            "term": "results",
            "tf": 2,
            "weight": 0.153846
          },
          {
            "term": "called",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "automatically",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "during",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "training",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "evaluator",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "model",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "output",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "path",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "epoch",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "steps",
            "tf": 1,
            "weight": 0.076923
          },
          {
            "term": "100",
            "tf": 1,
            "weight": 0.076923
          }
        ],
        "unique_terms": 12,
        "total_terms": 13
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Called automatically during training",
        "automatically",
        "called",
        "during",
        "epoch",
        "evaluator",
        "model",
        "output",
        "path",
        "results",
        "training"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.6,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.7899999999999999,
      "overall": 0.7633333333333333
    }
  },
  {
    "text": "### Model Card Integration  Evaluation results are automatically stored in the model's metadata via the `store_metrics_in_model_card_data()` method, which updates `model.model_card_data` with performance metrics. Sources: [sentence_transformers/evaluation/BinaryClassificationEvaluator.py:151-221](), [sentence_transformers/evaluation/RerankingEvaluator.py:137-198](), [sentence_transformers/evaluation/InformationRetrievalEvaluator.py:211-290]()",
    "metadata": {
      "chunk_id": "0f5b602ef62a-0009",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "file_extension": ".md",
      "chunk_index": 9,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Model Card Integration"
      ],
      "heading_text": "Model Card Integration",
      "token_count": 93,
      "char_count": 446,
      "start_char": 2545,
      "end_char": 2991,
      "semantic_score": 0.7,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5788888888888889,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "code_block",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1536,
      "processing_timestamp": "2025-10-20T16:07:46.146227",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 93,
      "document_id": "0f5b602ef62a",
      "document_name": "Prepare_samples_with_queries_positives_and_negatives",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "source_filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "hierarchy_path": "Model Card Integration",
      "chunk_hash": "a646cb362df2d536",
      "content_digest": "a646cb362df2d536",
      "chunk_length": 446,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1536,
      "matryoshka_dimension": 1536,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "model",
          "evaluation",
          "card",
          "sentence",
          "transformers",
          "the",
          "metrics",
          "data",
          "integration",
          "results",
          "are",
          "automatically",
          "stored",
          "metadata",
          "via",
          "store",
          "method",
          "which",
          "updates",
          "with"
        ],
        "term_weights": [
          {
            "term": "model",
            "tf": 5,
            "weight": 0.106383
          },
          {
            "term": "evaluation",
            "tf": 4,
            "weight": 0.085106
          },
          {
            "term": "card",
            "tf": 3,
            "weight": 0.06383
          },
          {
            "term": "sentence",
            "tf": 3,
            "weight": 0.06383
          },
          {
            "term": "transformers",
            "tf": 3,
            "weight": 0.06383
          },
          {
            "term": "the",
            "tf": 2,
            "weight": 0.042553
          },
          {
            "term": "metrics",
            "tf": 2,
            "weight": 0.042553
          },
          {
            "term": "data",
            "tf": 2,
            "weight": 0.042553
          },
          {
            "term": "integration",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "results",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "are",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "automatically",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "stored",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "metadata",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "via",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "store",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "method",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "which",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "updates",
            "tf": 1,
            "weight": 0.021277
          },
          {
            "term": "with",
            "tf": 1,
            "weight": 0.021277
          }
        ],
        "unique_terms": 31,
        "total_terms": 47
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Model Card Integration",
        "card",
        "data",
        "evaluation",
        "integration",
        "metrics",
        "model",
        "results",
        "sentence",
        "the",
        "transformers"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.7,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5788888888888889,
      "overall": 0.7262962962962963
    }
  },
  {
    "text": "## 8. Performance Considerations  When evaluating large datasets, consider:  - Batch processing: Evaluate models in batches to avoid memory issues - Caching: Cache model outputs to avoid redundant computation - Metrics selection: Choose metrics appropriate for your task and dataset size  Efficient evaluation is especially important when working with resource-intensive models or large test sets.",
    "metadata": {
      "chunk_id": "0f5b602ef62a-0012",
      "source_file": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "file_extension": ".md",
      "chunk_index": 12,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "8. Performance Considerations"
      ],
      "heading_text": "8. Performance Considerations",
      "token_count": 69,
      "char_count": 397,
      "start_char": 4018,
      "end_char": 4415,
      "semantic_score": 0.8,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5463636363636364,
      "chunking_strategy": "hybrid_adaptive_structural",
      "content_type": "list_section",
      "embedding_model": "jina-code-embeddings-1.5b",
      "embedding_dimension": 1536,
      "processing_timestamp": "2025-10-20T16:07:46.149378",
      "model_aware_chunking": true,
      "within_token_limit": true,
      "estimated_tokens": 69,
      "document_id": "0f5b602ef62a",
      "document_name": "Prepare_samples_with_queries_positives_and_negatives",
      "source_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "source_filename": "Prepare_samples_with_queries_positives_and_negatives.md",
      "source_directory": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers",
      "relative_path": "Docs\\Sentence_Transformer\\UKPLab\\sentence-transformers\\Prepare_samples_with_queries_positives_and_negatives.md",
      "hierarchy_path": "8. Performance Considerations",
      "chunk_hash": "1808e6d4382da50d",
      "content_digest": "1808e6d4382da50d",
      "chunk_length": 397,
      "payload_version": "1.3",
      "collection_hints": [
        "sentence_transformer"
      ],
      "target_model": "jina-code-embeddings-1.5b",
      "chunker_version": "v5_unified",
      "chunk_size_tokens": 26214,
      "chunk_overlap_tokens": 2621,
      "chunk_size_chars": 104856,
      "chunk_overlap_chars": 10484,
      "safety_margin": 0.8,
      "model_hf_id": "jinaai/jina-code-embeddings-1.5b",
      "model_max_tokens": 32768,
      "model_vector_dim": 1536,
      "matryoshka_dimension": 1536,
      "recommended_batch_size": 16,
      "backend": "pytorch",
      "memory_efficient": true,
      "query_prefix": "Encode this code snippet for semantic retrieval: ",
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "when",
          "large",
          "models",
          "avoid",
          "metrics",
          "performance",
          "considerations",
          "evaluating",
          "datasets",
          "consider",
          "batch",
          "processing",
          "evaluate",
          "batches",
          "memory",
          "issues",
          "caching",
          "cache",
          "model",
          "outputs"
        ],
        "term_weights": [
          {
            "term": "when",
            "tf": 2,
            "weight": 0.043478
          },
          {
            "term": "large",
            "tf": 2,
            "weight": 0.043478
          },
          {
            "term": "models",
            "tf": 2,
            "weight": 0.043478
          },
          {
            "term": "avoid",
            "tf": 2,
            "weight": 0.043478
          },
          {
            "term": "metrics",
            "tf": 2,
            "weight": 0.043478
          },
          {
            "term": "performance",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "considerations",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "evaluating",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "datasets",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "consider",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "batch",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "processing",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "evaluate",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "batches",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "memory",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "issues",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "caching",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "cache",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "model",
            "tf": 1,
            "weight": 0.021739
          },
          {
            "term": "outputs",
            "tf": 1,
            "weight": 0.021739
          }
        ],
        "unique_terms": 41,
        "total_terms": 46
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "8. Performance Considerations",
        "avoid",
        "consider",
        "considerations",
        "datasets",
        "evaluating",
        "large",
        "metrics",
        "models",
        "performance",
        "when"
      ],
      "collection_name": "Sentence_Transformer"
    },
    "advanced_scores": {
      "semantic": 0.8,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5463636363636364,
      "overall": 0.7487878787878787
    }
  }
]