[
  {
    "text": "## Snapshot Recovery Process  Recovery restores a snapshot by unpacking segment data and reinitializing the shard. The `LocalShard::restore_snapshot` method handles segment-level recovery. LocalShard Recovery: Segment restoration from snapshot archive ``` ```",
    "metadata": {
      "chunk_id": "b2d3ecd2f45b-0006",
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "file_extension": ".md",
      "chunk_index": 6,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Snapshot Recovery Process"
      ],
      "heading_text": "Snapshot Recovery Process",
      "token_count": 48,
      "char_count": 259,
      "start_char": 0,
      "end_char": 259,
      "semantic_score": 0.6988393664360046,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.5319354838709677,
      "chunking_strategy": "hierarchical_balanced",
      "content_type": "hierarchical_section",
      "embedding_model": "nomic-ai/CodeRankEmbed",
      "processing_timestamp": "2025-10-19T15:44:56.595153",
      "document_id": "b2d3ecd2f45b",
      "document_name": "_qdrant_qdrant_8-snapshots-and-recovery",
      "source_path": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_directory": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant",
      "relative_path": "Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "hierarchy_path": "Snapshot Recovery Process",
      "chunk_hash": "bf772698cc181c94",
      "content_digest": "bf772698cc181c94",
      "chunk_length": 259,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant_ecosystem"
      ],
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "snapshot",
          "recovery",
          "segment",
          "the",
          "localshard",
          "process",
          "restores",
          "unpacking",
          "data",
          "and",
          "reinitializing",
          "shard",
          "restore",
          "method",
          "handles",
          "level",
          "restoration",
          "from",
          "archive"
        ],
        "term_weights": [
          {
            "term": "snapshot",
            "tf": 4,
            "weight": 0.137931
          },
          {
            "term": "recovery",
            "tf": 4,
            "weight": 0.137931
          },
          {
            "term": "segment",
            "tf": 3,
            "weight": 0.103448
          },
          {
            "term": "the",
            "tf": 2,
            "weight": 0.068966
          },
          {
            "term": "localshard",
            "tf": 2,
            "weight": 0.068966
          },
          {
            "term": "process",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "restores",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "unpacking",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "data",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "and",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "reinitializing",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "shard",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "restore",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "method",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "handles",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "level",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "restoration",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "from",
            "tf": 1,
            "weight": 0.034483
          },
          {
            "term": "archive",
            "tf": 1,
            "weight": 0.034483
          }
        ],
        "unique_terms": 19,
        "total_terms": 29
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Snapshot Recovery Process",
        "and",
        "data",
        "localshard",
        "process",
        "recovery",
        "restores",
        "segment",
        "snapshot",
        "the",
        "unpacking"
      ],
      "quality_fallback": true,
      "quality_notes": "Promoted via relaxed thresholds"
    },
    "advanced_scores": {
      "semantic": 0.6988393664360046,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.5319354838709677,
      "overall": 0.7102582834356573
    }
  },
  {
    "text": "## Snapshot Creation Process  The `LocalShard::create_snapshot` method orchestrates the complete snapshot creation process, with special handling for the WAL and coordination with the update system. LocalShard Snapshot Creation: WAL handling and segment archiving ``` ```",
    "metadata": {
      "chunk_id": "b2d3ecd2f45b-0003",
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "file_extension": ".md",
      "chunk_index": 3,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Snapshot Creation Process"
      ],
      "heading_text": "Snapshot Creation Process",
      "token_count": 50,
      "char_count": 271,
      "start_char": 0,
      "end_char": 271,
      "semantic_score": 0.7191457152366638,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.49571428571428566,
      "chunking_strategy": "hierarchical_balanced",
      "content_type": "hierarchical_section",
      "embedding_model": "nomic-ai/CodeRankEmbed",
      "processing_timestamp": "2025-10-19T15:44:56.591915",
      "document_id": "b2d3ecd2f45b",
      "document_name": "_qdrant_qdrant_8-snapshots-and-recovery",
      "source_path": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_directory": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant",
      "relative_path": "Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "hierarchy_path": "Snapshot Creation Process",
      "chunk_hash": "67930b40b6c7b994",
      "content_digest": "67930b40b6c7b994",
      "chunk_length": 271,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant_ecosystem"
      ],
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "snapshot",
          "the",
          "creation",
          "process",
          "localshard",
          "with",
          "handling",
          "wal",
          "and",
          "create",
          "method",
          "orchestrates",
          "complete",
          "special",
          "for",
          "coordination",
          "update",
          "system",
          "segment",
          "archiving"
        ],
        "term_weights": [
          {
            "term": "snapshot",
            "tf": 4,
            "weight": 0.117647
          },
          {
            "term": "the",
            "tf": 4,
            "weight": 0.117647
          },
          {
            "term": "creation",
            "tf": 3,
            "weight": 0.088235
          },
          {
            "term": "process",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "localshard",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "with",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "handling",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "wal",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "and",
            "tf": 2,
            "weight": 0.058824
          },
          {
            "term": "create",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "method",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "orchestrates",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "complete",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "special",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "for",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "coordination",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "update",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "system",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "segment",
            "tf": 1,
            "weight": 0.029412
          },
          {
            "term": "archiving",
            "tf": 1,
            "weight": 0.029412
          }
        ],
        "unique_terms": 20,
        "total_terms": 34
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Snapshot Creation Process",
        "and",
        "create",
        "creation",
        "handling",
        "localshard",
        "process",
        "snapshot",
        "the",
        "wal",
        "with"
      ],
      "quality_fallback": true,
      "quality_notes": "Promoted via relaxed thresholds"
    },
    "advanced_scores": {
      "semantic": 0.7191457152366638,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.49571428571428566,
      "overall": 0.7049533336503164
    }
  },
  {
    "text": "## Segment Proxying Mechanism  The key innovation in Qdrant's snapshot system is the segment proxying mechanism, which allows writes to continue during snapshot creation. This is implemented in `proxy_all_segments_and_apply`. Segment Proxying: Temporary redirection of writes during snapshot ``` ``` The `proxy_all_segments_and_apply` function performs the following steps:  1. **Acquire upgradable read lock** on `SegmentHolder` to prevent external modifications 2. **Create temporary segment** to receive all writes during snapshot 3. **Wrap all segments in ProxySegment** - each proxy redirects writes to the temporary segment while allowing reads from the wrapped segment 4. **Apply operation** (e.g., `take_snapshot`) to each wrapped segment sequentially 5. **Unproxy segments incrementally** - as each segment finishes, restore it to reduce proxy overhead 6. **Final atomic unproxy** - restore remaining segments and promote temporary segment if it has data  This mechanism ensures:  - **No write blocking**: Updates continue via temporary segment during long-running snapshot operations - **Consistent point-in-time view**: All wrapped segments represent the same moment - **Minimal proxy duration**: Segments are unproxied as soon as their snapshot completes - **Atomic state transitions**: All segment changes use proper locking  Sources: [lib/collection/src/shards/local\\_shard/snapshot.rs268-352](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/snapshot.rs#L268-L352) [lib/collection/src/shards/local\\_shard/mod.rs108-124](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/mod.rs#L108-L124)",
    "metadata": {
      "chunk_id": "b2d3ecd2f45b-0002",
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "file_extension": ".md",
      "chunk_index": 2,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Segment Proxying Mechanism"
      ],
      "heading_text": "Segment Proxying Mechanism",
      "token_count": 368,
      "char_count": 1673,
      "start_char": 0,
      "end_char": 1673,
      "semantic_score": 0.46984392404556274,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.7022032786885246,
      "chunking_strategy": "hierarchical_balanced",
      "content_type": "hierarchical_section",
      "embedding_model": "nomic-ai/CodeRankEmbed",
      "processing_timestamp": "2025-10-19T15:44:56.591301",
      "document_id": "b2d3ecd2f45b",
      "document_name": "_qdrant_qdrant_8-snapshots-and-recovery",
      "source_path": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_directory": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant",
      "relative_path": "Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "hierarchy_path": "Segment Proxying Mechanism",
      "chunk_hash": "1efbd8ec197f432d",
      "content_digest": "1efbd8ec197f432d",
      "chunk_length": 1673,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant_ecosystem"
      ],
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "segment",
          "snapshot",
          "the",
          "segments",
          "all",
          "qdrant",
          "proxy",
          "temporary",
          "writes",
          "during",
          "lib",
          "collection",
          "src",
          "shards",
          "local",
          "shard",
          "proxying",
          "mechanism",
          "and",
          "apply"
        ],
        "term_weights": [
          {
            "term": "segment",
            "tf": 11,
            "weight": 0.053659
          },
          {
            "term": "snapshot",
            "tf": 9,
            "weight": 0.043902
          },
          {
            "term": "the",
            "tf": 7,
            "weight": 0.034146
          },
          {
            "term": "segments",
            "tf": 7,
            "weight": 0.034146
          },
          {
            "term": "all",
            "tf": 6,
            "weight": 0.029268
          },
          {
            "term": "qdrant",
            "tf": 5,
            "weight": 0.02439
          },
          {
            "term": "proxy",
            "tf": 5,
            "weight": 0.02439
          },
          {
            "term": "temporary",
            "tf": 5,
            "weight": 0.02439
          },
          {
            "term": "writes",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "during",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "lib",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "collection",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "src",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "shards",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "local",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "shard",
            "tf": 4,
            "weight": 0.019512
          },
          {
            "term": "proxying",
            "tf": 3,
            "weight": 0.014634
          },
          {
            "term": "mechanism",
            "tf": 3,
            "weight": 0.014634
          },
          {
            "term": "and",
            "tf": 3,
            "weight": 0.014634
          },
          {
            "term": "apply",
            "tf": 3,
            "weight": 0.014634
          }
        ],
        "unique_terms": 111,
        "total_terms": 205
      },
      "modal_hint": "code",
      "content_flags": {
        "has_code_block": true,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Segment Proxying Mechanism",
        "all",
        "during",
        "proxy",
        "qdrant",
        "segment",
        "segments",
        "snapshot",
        "temporary",
        "the",
        "writes"
      ],
      "quality_fallback": true,
      "quality_notes": "Promoted via relaxed thresholds"
    },
    "advanced_scores": {
      "semantic": 0.46984392404556274,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.7022032786885246,
      "overall": 0.6906824009113625
    }
  },
  {
    "text": "# Snapshots and Recovery  Relevant source files  - [lib/collection/benches/batch\\_query\\_bench.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/benches/batch_query_bench.rs) - [lib/collection/benches/batch\\_search\\_bench.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/benches/batch_search_bench.rs) - [lib/collection/src/collection\\_manager/collection\\_updater.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/collection_manager/collection_updater.rs) - [lib/collection/src/shards/local\\_shard/mod.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/mod.rs) - [lib/collection/src/shards/local\\_shard/scroll.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/scroll.rs) - [lib/collection/src/shards/local\\_shard/snapshot.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/snapshot.rs) - [lib/collection/src/shards/local\\_shard/snapshot\\_tests.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/shards/local_shard/snapshot_tests.rs) - [lib/collection/src/tests/snapshot\\_test.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/tests/snapshot_test.rs) - [lib/collection/src/update\\_handler.rs](https://github.com/qdrant/qdrant/blob/48203e41/lib/collection/src/update_handler.rs)  This page describes Qdrant's snapshot and recovery system, which provides data backup, restoration, and cluster synchronization capabilities. The system supports both full collection snapshots and individual shard snapshots, with various recovery strategies for distributed deployments. For information about collection management and optimization processes, see [Update Processing and Optimization](qdrant/qdrant/5.1-query-request-flow.md). For consensus mechanisms that coordinate snapshot operations in distributed mode, see [Consensus Mechanism](qdrant/qdrant/6-data-updates-and-consistency.md).",
    "metadata": {
      "chunk_id": "b2d3ecd2f45b-0000",
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "file_extension": ".md",
      "chunk_index": 0,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Snapshots and Recovery"
      ],
      "heading_text": "Snapshots and Recovery",
      "token_count": 511,
      "char_count": 1984,
      "start_char": 0,
      "end_char": 1984,
      "semantic_score": 0.37175801396369934,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.7232558139534884,
      "chunking_strategy": "hierarchical_balanced",
      "content_type": "hierarchical_section",
      "embedding_model": "nomic-ai/CodeRankEmbed",
      "processing_timestamp": "2025-10-19T15:44:56.588911",
      "document_id": "b2d3ecd2f45b",
      "document_name": "_qdrant_qdrant_8-snapshots-and-recovery",
      "source_path": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_directory": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant",
      "relative_path": "Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "hierarchy_path": "Snapshots and Recovery",
      "chunk_hash": "22a41ab4fe78fbe1",
      "content_digest": "22a41ab4fe78fbe1",
      "chunk_length": 1984,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant_ecosystem"
      ],
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "collection",
          "qdrant",
          "lib",
          "src",
          "https",
          "github",
          "com",
          "blob",
          "48203e41",
          "shard",
          "shards",
          "local",
          "snapshot",
          "and",
          "benches",
          "batch",
          "bench",
          "tests",
          "snapshots",
          "recovery"
        ],
        "term_weights": [
          {
            "term": "collection",
            "tf": 24,
            "weight": 0.093023
          },
          {
            "term": "qdrant",
            "tf": 23,
            "weight": 0.089147
          },
          {
            "term": "lib",
            "tf": 18,
            "weight": 0.069767
          },
          {
            "term": "src",
            "tf": 14,
            "weight": 0.054264
          },
          {
            "term": "https",
            "tf": 9,
            "weight": 0.034884
          },
          {
            "term": "github",
            "tf": 9,
            "weight": 0.034884
          },
          {
            "term": "com",
            "tf": 9,
            "weight": 0.034884
          },
          {
            "term": "blob",
            "tf": 9,
            "weight": 0.034884
          },
          {
            "term": "48203e41",
            "tf": 9,
            "weight": 0.034884
          },
          {
            "term": "shard",
            "tf": 9,
            "weight": 0.034884
          },
          {
            "term": "shards",
            "tf": 8,
            "weight": 0.031008
          },
          {
            "term": "local",
            "tf": 8,
            "weight": 0.031008
          },
          {
            "term": "snapshot",
            "tf": 8,
            "weight": 0.031008
          },
          {
            "term": "and",
            "tf": 7,
            "weight": 0.027132
          },
          {
            "term": "benches",
            "tf": 4,
            "weight": 0.015504
          },
          {
            "term": "batch",
            "tf": 4,
            "weight": 0.015504
          },
          {
            "term": "bench",
            "tf": 4,
            "weight": 0.015504
          },
          {
            "term": "tests",
            "tf": 4,
            "weight": 0.015504
          },
          {
            "term": "snapshots",
            "tf": 3,
            "weight": 0.011628
          },
          {
            "term": "recovery",
            "tf": 3,
            "weight": 0.011628
          }
        ],
        "unique_terms": 73,
        "total_terms": 258
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "48203e41",
        "Snapshots and Recovery",
        "blob",
        "collection",
        "com",
        "github",
        "https",
        "lib",
        "qdrant",
        "shard",
        "src"
      ],
      "quality_fallback": true,
      "quality_notes": "Promoted via relaxed thresholds"
    },
    "advanced_scores": {
      "semantic": 0.37175801396369934,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.7232558139534884,
      "overall": 0.6650046093057292
    }
  },
  {
    "text": "### Recovery Implementation Details  The recovery process follows these steps:  1. **Read snapshot directory**: `LocalShard::restore_snapshot` reads the `segments/` directory from the snapshot path 2. **Filter entries**: Hidden files (starting with `.`) are skipped to avoid temporary or system files 3. **Per-segment recovery**: Each segment directory calls `Segment::restore_snapshot_in_place` to unpack its data 4. **In-place restoration**: Segments restore themselves directly into their final location (no temporary moves) 5. **Error propagation**: Any segment restoration failure aborts the entire recovery  Key characteristics:  - **No WAL replay**: Recovery assumes snapshot contains complete data; WAL (if present) provides operation history but isn't replayed - **Atomic per-segment**: Each segment restores atomically, but overall recovery is not atomic across all segments - **Path-based**: Recovery expects a specific directory structure with `segments/` and `wal/` subdirectories",
    "metadata": {
      "chunk_id": "b2d3ecd2f45b-0007",
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "file_extension": ".md",
      "chunk_index": 7,
      "document_level": 1,
      "parent_chunk_id": null,
      "child_chunk_ids": [],
      "section_path": [
        "Recovery Implementation Details"
      ],
      "heading_text": "Recovery Implementation Details",
      "token_count": 202,
      "char_count": 993,
      "start_char": 0,
      "end_char": 993,
      "semantic_score": 0.2023790180683136,
      "structural_score": 0.8999999999999999,
      "retrieval_quality": 0.7304761904761904,
      "chunking_strategy": "hierarchical_balanced",
      "content_type": "hierarchical_section",
      "embedding_model": "nomic-ai/CodeRankEmbed",
      "processing_timestamp": "2025-10-19T15:44:56.595659",
      "document_id": "b2d3ecd2f45b",
      "document_name": "_qdrant_qdrant_8-snapshots-and-recovery",
      "source_path": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_filename": "_qdrant_qdrant_8-snapshots-and-recovery.md",
      "source_directory": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_qdrant",
      "relative_path": "Docs\\qdrant_ecosystem\\qdrant_qdrant\\_qdrant_qdrant_8-snapshots-and-recovery.md",
      "hierarchy_path": "Recovery Implementation Details",
      "chunk_hash": "7ae1718eed3c9049",
      "content_digest": "7ae1718eed3c9049",
      "chunk_length": 993,
      "payload_version": "1.3",
      "collection_hints": [
        "qdrant_ecosystem"
      ],
      "sparse_features": {
        "version": "1.0",
        "weighting": "tf-normalized",
        "top_terms": [
          "recovery",
          "segment",
          "snapshot",
          "the",
          "directory",
          "segments",
          "restore",
          "wal",
          "path",
          "files",
          "with",
          "temporary",
          "per",
          "each",
          "place",
          "data",
          "restoration",
          "but",
          "atomic",
          "implementation"
        ],
        "term_weights": [
          {
            "term": "recovery",
            "tf": 7,
            "weight": 0.060345
          },
          {
            "term": "segment",
            "tf": 6,
            "weight": 0.051724
          },
          {
            "term": "snapshot",
            "tf": 5,
            "weight": 0.043103
          },
          {
            "term": "the",
            "tf": 4,
            "weight": 0.034483
          },
          {
            "term": "directory",
            "tf": 4,
            "weight": 0.034483
          },
          {
            "term": "segments",
            "tf": 4,
            "weight": 0.034483
          },
          {
            "term": "restore",
            "tf": 3,
            "weight": 0.025862
          },
          {
            "term": "wal",
            "tf": 3,
            "weight": 0.025862
          },
          {
            "term": "path",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "files",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "with",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "temporary",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "per",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "each",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "place",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "data",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "restoration",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "but",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "atomic",
            "tf": 2,
            "weight": 0.017241
          },
          {
            "term": "implementation",
            "tf": 1,
            "weight": 0.008621
          }
        ],
        "unique_terms": 77,
        "total_terms": 116
      },
      "modal_hint": "prose",
      "content_flags": {
        "has_code_block": false,
        "has_table": false,
        "has_list": false,
        "has_json": false,
        "has_formula": false
      },
      "search_keywords": [
        "Recovery Implementation Details",
        "directory",
        "files",
        "path",
        "recovery",
        "restore",
        "segment",
        "segments",
        "snapshot",
        "the",
        "wal"
      ],
      "quality_fallback": true,
      "quality_notes": "Promoted via relaxed thresholds"
    },
    "advanced_scores": {
      "semantic": 0.2023790180683136,
      "structural": 0.8999999999999999,
      "retrieval_quality": 0.7304761904761904,
      "overall": 0.6109517361815012
    }
  }
]