{
  "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\qdrant_ecosystem\\qdrant_fastembed\\_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
  "source_repo": "qdrant_fastembed",
  "total_chunks": 5,
  "chunks": [
    {
      "content": "ColBERT and Late Interaction | qdrant/fastembed | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[qdrant/fastembed](https://github.com/qdrant/fastembed \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 20 April 2025 ([b78564](https://github.com/qdrant/fastembed/commits/b785640b))\n\n- [Overview](qdrant/fastembed/1-overview.md)\n- [Installation and Setup](qdrant/fastembed/2-installation-and-setup.md)\n- [Core Embedding Classes](qdrant/fastembed/3-core-embedding-classes.md)\n- [TextEmbedding](qdrant/fastembed/3.1-textembedding.md)\n- [SparseTextEmbedding](qdrant/fastembed/3.2-sparsetextembedding.md)\n- [LateInteractionTextEmbedding](qdrant/fastembed/3.3-lateinteractiontextembedding.md)\n- [ImageEmbedding](qdrant/fastembed/3.4-imageembedding.md)\n- [LateInteractionMultimodalEmbedding](qdrant/fastembed/3.5-lateinteractionmultimodalembedding.md)\n- [TextCrossEncoder](qdrant/fastembed/3.6-textcrossencoder.md)\n- [Architecture](qdrant/fastembed/4-architecture.md)\n- [Model Management](qdrant/fastembed/4.1-model-management.md)\n- [ONNX Runtime Integration](qdrant/fastembed/4.2-onnx-runtime-integration.md)\n- [Parallel Processing](qdrant/fastembed/4.3-parallel-processing.md)\n- [Implementation Details](qdrant/fastembed/5-implementation-details.md)\n- [Dense Text Embeddings](qdrant/fastembed/5.1-dense-text-embeddings.md)\n- [Sparse Text Embeddings](qdrant/fastembed/5.2-sparse-text-embeddings.md)\n- [Late Interaction Models](qdrant/fastembed/5.3-late-interaction-models.md)\n- [Multimodal Models](qdrant/fastembed/5.4-multimodal-models.md)\n- [Supported Models](qdrant/fastembed/6-supported-models.md)\n- [Usage Examples](qdrant/fastembed/7-usage-examples.md)\n- [Basic Text Embedding](qdrant/fastembed/7.1-basic-text-embedding.md)\n- [Sparse and Hybrid Search](qdrant/fastembed/7.2-sparse-and-hybrid-search.md)\n- [ColBERT and Late Interaction](qdrant/fastembed/7.3-colbert-and-late-interaction.md)\n- [Image Embedding](qdrant/fastembed/7.",
      "index": 0,
      "token_count": 622,
      "metadata": {
        "title": "_qdrant_fastembed_7.3-colbert-and-late-interaction",
        "source": "qdrant_fastembed\\_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "chunk_method": "simple_fallback",
        "source_repo": "qdrant_fastembed",
        "source_subdir": "root",
        "category": "general",
        "file_path": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "file_name": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "collection": "qdrant_ecosystem",
        "processed_date": "2025-10-16T01:58:34.750570",
        "total_chunks": 5
      },
      "start_char": 0,
      "end_char": 2047
    },
    {
      "content": "ction](qdrant/fastembed/7.3-colbert-and-late-interaction.md)\n- [Image Embedding](qdrant/fastembed/7.4-image-embedding.md)\n- [Performance Optimization](qdrant/fastembed/8-performance-optimization.md)\n- [Integration with Qdrant](qdrant/fastembed/9-integration-with-qdrant.md)\n- [Development Guide](qdrant/fastembed/10-development-guide.md)\n\nMenu\n\n# ColBERT and Late Interaction\n\nRelevant source files\n\n- [fastembed/late\\_interaction/colbert.py](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py)\n\nThis page explains how to use FastEmbed's implementation of ColBERT for late interaction embeddings. Late interaction is a retrieval approach that defers token-to-token interaction between queries and documents until the final ranking stage, offering improved precision compared to traditional dense embeddings. For information about other embedding approaches, see [Dense Text Embeddings](qdrant/fastembed/5.1-dense-text-embeddings.md) or [Sparse Text Embeddings](qdrant/fastembed/5.2-sparse-text-embeddings.md).\n\n## What is ColBERT and Late Interaction?\n\nColBERT (Contextualized Late Interaction over BERT) is a retrieval model architecture that represents documents and queries as bags of contextualized embeddings rather than single vector representations. Unlike dense text embeddings that compress entire texts into single vectors, ColBERT preserves token-level information by:\n\n1. Embedding each token in a document or query separately\n2. Performing \"late interaction\" by computing fine-grained similarity between tokens only at retrieval time\n\nThis approach provides higher precision because it retains more context and semantic information, making it particularly effective for complex information retrieval tasks.\n\n```\n```\n\nSources: [fastembed/late\\_interaction/colbert.py39-65](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L39-L65)\n\n## ColBERT in FastEmbed Architecture",
      "index": 1,
      "token_count": 445,
      "metadata": {
        "title": "_qdrant_fastembed_7.3-colbert-and-late-interaction",
        "source": "qdrant_fastembed\\_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "chunk_method": "simple_fallback",
        "source_repo": "qdrant_fastembed",
        "source_subdir": "root",
        "category": "general",
        "file_path": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "file_name": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "collection": "qdrant_ecosystem",
        "processed_date": "2025-10-16T01:58:34.750570",
        "total_chunks": 5
      },
      "start_char": 1947,
      "end_char": 3905
    },
    {
      "content": "blob/b785640b/fastembed/late_interaction/colbert.py#L39-L65)\n\n## ColBERT in FastEmbed Architecture\n\nFastEmbed implements ColBERT through the `LateInteractionTextEmbedding` entry point class, which uses the `Colbert` implementation class. This fits into the larger FastEmbed architecture as follows:\n\n```\n```\n\nSources: [fastembed/late\\_interaction/colbert.py39-40](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L39-L40)\n\n## Supported Models\n\nFastEmbed currently supports these ColBERT models:\n\n| Model Name                            | Dimensions | Description                                                       | License    | Size (GB) |\n| ------------------------------------- | ---------- | ----------------------------------------------------------------- | ---------- | --------- |\n| colbert-ir/colbertv2.0                | 128        | Late interaction model                                            | MIT        | 0.44      |\n| answerdotai/answerai-colbert-small-v1 | 96         | Text embeddings, Multilingual (\\~100 languages), 512 input tokens | Apache 2.0 | 0.13      |\n\nSources: [fastembed/late\\_interaction/colbert.py17-36](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L17-L36)\n\n## Using ColBERT in FastEmbed\n\n### Basic Usage\n\nHere's how to use ColBERT for late interaction embeddings:\n\n```\n```\n\nThe key difference between ColBERT and standard dense embeddings is that:\n\n- Documents are embedded at indexing time\n- Queries are embedded at search time\n- The two never interact until the final similarity calculation\n\n### ColBERT Embedding Process\n\n```\n```\n\nSources: [fastembed/late\\_interaction/colbert.py67-104](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L67-L104) [fastembed/late\\_interaction/colbert.py205-249](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L205-L249)\n\n## Implementation Details\n\n### Special Token Handling",
      "index": 2,
      "token_count": 514,
      "metadata": {
        "title": "_qdrant_fastembed_7.3-colbert-and-late-interaction",
        "source": "qdrant_fastembed\\_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "chunk_method": "simple_fallback",
        "source_repo": "qdrant_fastembed",
        "source_subdir": "root",
        "category": "general",
        "file_path": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "file_name": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "collection": "qdrant_ecosystem",
        "processed_date": "2025-10-16T01:58:34.750570",
        "total_chunks": 5
      },
      "start_char": 3805,
      "end_char": 5820
    },
    {
      "content": "mbed/late_interaction/colbert.py#L205-L249)\n\n## Implementation Details\n\n### Special Token Handling\n\nColBERT uses different marker tokens for queries and documents to help the model distinguish their roles:\n\n- `QUERY_MARKER_TOKEN_ID = 1` - Added to queries\n- `DOCUMENT_MARKER_TOKEN_ID = 2` - Added to documents\n\nFor queries, ColBERT also pads shorter queries with mask tokens up to a minimum length (31 tokens) to improve retrieval performance through query augmentation.\n\nSources: [fastembed/late\\_interaction/colbert.py40-43](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L40-L43) [fastembed/late\\_interaction/colbert.py86-104](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L86-L104)\n\n### Document Embedding Post-Processing\n\nA key aspect of ColBERT is how document embeddings are post-processed:\n\n1. Punctuation and padding tokens are masked out (attention mask set to 0)\n2. The attention mask is applied to the model output\n3. Token embeddings are normalized to unit length\n\n```\n```\n\nSources: [fastembed/late\\_interaction/colbert.py45-65](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L45-L65)\n\n### Tokenization Process\n\nThe tokenization process differs between queries and documents:\n\n1. **Documents**: Standard tokenization with truncation\n2. **Queries**: Tokenized and padded with `[MASK]` tokens to a minimum length\n\nThe tokenizer also handles special considerations like truncation to avoid overflow after adding marker tokens.\n\nSources: [fastembed/late\\_interaction/colbert.py79-108](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L79-L108) [fastembed/late\\_interaction/colbert.py195-203](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L195-L203)\n\n## Performance Considerations\n\nThe ColBERT approach offers higher precision but comes with trade-offs:\n\n1. **Storage**: Requires more storage than dense embeddings (token-level vs.",
      "index": 3,
      "token_count": 545,
      "metadata": {
        "title": "_qdrant_fastembed_7.3-colbert-and-late-interaction",
        "source": "qdrant_fastembed\\_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "chunk_method": "simple_fallback",
        "source_repo": "qdrant_fastembed",
        "source_subdir": "root",
        "category": "general",
        "file_path": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "file_name": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "collection": "qdrant_ecosystem",
        "processed_date": "2025-10-16T01:58:34.750570",
        "total_chunks": 5
      },
      "start_char": 5720,
      "end_char": 7764
    },
    {
      "content": "comes with trade-offs:\n\n1. **Storage**: Requires more storage than dense embeddings (token-level vs. single vector)\n2. **Computation**: Late interaction calculation is more computationally intensive at search time\n3. **Memory**: Uses more memory during search due to token-level operations\n\nFor optimal performance, FastEmbed implements ColBERT using ONNX Runtime for efficient inference and supports parallel processing for batch embedding.\n\nSources: [fastembed/late\\_interaction/colbert.py205-237](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/late_interaction/colbert.py#L205-L237)\n\n## Working with Vector Databases\n\nWhen using ColBERT with vector databases like Qdrant, you'll need to store the token-level embeddings and implement the late interaction scoring during retrieval. This often requires custom extensions or specialized vector database support for ColBERT's retrieval mechanism.\n\nFor more information on integrating with Qdrant specifically, see [Integration with Qdrant](qdrant/fastembed/9-integration-with-qdrant.md).\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [ColBERT and Late Interaction](#colbert-and-late-interaction.md)\n- [What is ColBERT and Late Interaction?](#what-is-colbert-and-late-interaction.md)\n- [ColBERT in FastEmbed Architecture](#colbert-in-fastembed-architecture.md)\n- [Supported Models](#supported-models.md)\n- [Using ColBERT in FastEmbed](#using-colbert-in-fastembed.md)\n- [Basic Usage](#basic-usage.md)\n- [ColBERT Embedding Process](#colbert-embedding-process.md)\n- [Implementation Details](#implementation-details.md)\n- [Special Token Handling](#special-token-handling.md)\n- [Document Embedding Post-Processing](#document-embedding-post-processing.md)\n- [Tokenization Process](#tokenization-process.md)\n- [Performance Considerations](#performance-considerations.md)\n- [Working with Vector Databases](#working-with-vector-databases.md)",
      "index": 4,
      "token_count": 441,
      "metadata": {
        "title": "_qdrant_fastembed_7.3-colbert-and-late-interaction",
        "source": "qdrant_fastembed\\_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "chunk_method": "simple_fallback",
        "source_repo": "qdrant_fastembed",
        "source_subdir": "root",
        "category": "general",
        "file_path": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "file_name": "_qdrant_fastembed_7.3-colbert-and-late-interaction.md",
        "collection": "qdrant_ecosystem",
        "processed_date": "2025-10-16T01:58:34.750570",
        "total_chunks": 5
      },
      "start_char": 7664,
      "end_char": 9712
    }
  ]
}