[
  {
    "text": "Model Management | qdrant/fastembed | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[qdrant/fastembed](https://github.com/qdrant/fastembed \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 20 April 2025 ([b78564](https://github.com/qdrant/fastembed/commits/b785640b))\n\n- [Overview](qdrant/fastembed/1-overview.md)\n- [Installation and Setup](qdrant/fastembed/2-installation-and-setup.md)\n- [Core Embedding Classes](qdrant/fastembed/3-core-embedding-classes.md)\n- [TextEmbedding](qdrant/fastembed/3.1-textembedding.md)\n- [SparseTextEmbedding](qdrant/fastembed/3.2-sparsetextembedding.md)\n- [LateInteractionTextEmbedding](qdrant/fastembed/3.3-lateinteractiontextembedding.md)\n- [ImageEmbedding](qdrant/fastembed/3.4-imageembedding.md)\n- [LateInteractionMultimodalEmbedding](qdrant/fastembed/3.5-lateinteractionmultimodalembedding.md)\n- [TextCrossEncoder](qdrant/fastembed/3.6-textcrossencoder.md)\n- [Architecture](qdrant/fastembed/4-architecture.md)\n- [Model Management](qdrant/fastembed/4.1-model-management.md)\n- [ONNX Runtime Integration](qdrant/fastembed/4.2-onnx-runtime-integration.md)\n- [Parallel Processing](qdrant/fastembed/4.3-parallel-processing.md)\n- [Implementation Details](qdrant/fastembed/5-implementation-details.md)\n- [Dense Text Embeddings](qdrant/fastembed/5.1-dense-text-embeddings.md)\n- [Sparse Text Embeddings](qdrant/fastembed/5.2-sparse-text-embeddings.md)\n- [Late Interaction Models](qdrant/fastembed/5.3-late-interaction-models.md)\n- [Multimodal Models](qdrant/fastembed/5.4-multimodal-models.md)\n- [Supported Models](qdrant/fastembed/6-supported-models.md)\n- [Usage Examples](qdrant/fastembed/7-usage-examples.md)\n- [Basic Text Embedding](qdrant/fastembed/7.1-basic-text-embedding.md)\n- [Sparse and Hybrid Search](qdrant/fastembed/7.2-sparse-and-hybrid-search.md)\n- [ColBERT and Late Interaction](qdrant/fastembed/7.3-colbert-and-late-interaction.md)\n- [Image Embedding](qdrant/fastembed/7.4-image-embedding.md)\n- [Performance Optimization](qdrant/fastembed/8-performance-optimization.md)\n- [Integration with Qdrant](qdrant/fastembed/9-integration-with-qdrant.md)\n- [Development Guide](qdrant/fastembed/10-development-guide.md)\n\nMenu\n\n# Model Management\n\nRelevant source files\n\n- [fastembed/common/\\_\\_init\\_\\_.py](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/__init__.py)\n- [fastembed/common/model\\_management.py](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py)\n- [fastembed/common/types.py](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/types.py)\n- [fastembed/common/utils.py](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/utils.py)\n- [fastembed/text/text\\_embedding\\_base.py](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/text/text_embedding_base.py)\n\nThis document explains how FastEmbed manages embedding models, including downloading, caching, and verification processes. Model Management is a core subsystem responsible for ensuring models are efficiently retrieved and stored locally for embedding generation. For information about the actual embedding process, see [Core Embedding Classes](qdrant/fastembed/3-core-embedding-classes.md).\n\n## Overview\n\nThe Model Management subsystem provides a unified interface for:\n\n- Downloading models from different sources (HuggingFace Hub, Google Cloud Storage)\n- Caching models locally to avoid redundant downloads\n- Verifying the integrity of downloaded models\n- Supporting custom model registration\n\nIt serves as the foundation for all embedding classes in FastEmbed, enabling them to retrieve model files regardless of their source.\n\n```\n```",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_fastembed\\_qdrant_fastembed_4.1-model-management.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 990,
      "character_count": 3756,
      "created_at": "2025-10-16T17:42:30.081100",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_fastembed",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "Qdrant\\qdrant_fastembed\\_qdrant_fastembed_4.1-model-management.md",
      "collection_context": "Qdrant/qdrant_fastembed"
    }
  },
  {
    "text": "Sources: [fastembed/common/model\\_management.py377-458](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L377-L458)\n\n## Architecture\n\nThe Model Management system is designed as a generic base class that can handle different types of model descriptions. It integrates with the broader FastEmbed architecture as the foundation for embedding model access.\n\n```\n```\n\nSources: [fastembed/common/model\\_management.py24-458](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L24-L458) [fastembed/text/text\\_embedding\\_base.py8-60](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/text/text_embedding_base.py#L8-L60)\n\n## Model Sources and Retrieval\n\nFastEmbed supports retrieving models from multiple sources:\n\n1. **HuggingFace Hub**: Primary source for many models, providing version control and metadata\n2. **Google Cloud Storage**: Alternative source, especially for optimized ONNX models\n\nThe system intelligently chooses the appropriate source based on model description and availability.\n\n```\n```\n\nSources: [fastembed/common/model\\_management.py377-458](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L377-L458)\n\n### HuggingFace Download Process\n\nWhen downloading from HuggingFace, FastEmbed follows these steps:\n\n1. Check if files are already cached locally\n2. Verify files against metadata if present\n3. Download required files using `snapshot_download()`\n4. Collect and store metadata for future verification\n\nThe system uses a pattern-based approach to download only necessary files, reducing download size and time.\n\n```\n```\n\nSources: [fastembed/common/model\\_management.py132-288](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L132-L288)\n\n### Google Cloud Storage Download Process\n\nFor models hosted on Google Cloud Storage:\n\n1. Check if model is already cached locally\n2. Download the compressed model archive\n3. Decompress to temporary directory\n4. Move to final cache location\n\nThis process handles compressed archives (`.tar.gz`) containing the ONNX model and supporting files.\n\nSources: [fastembed/common/model\\_management.py327-375](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L327-L375) [fastembed/common/model\\_management.py291-325](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L291-L325)\n\n## Caching Mechanism\n\nFastEmbed implements an efficient caching mechanism to avoid redundant downloads and improve performance.\n\n### Cache Directory Structure\n\n```\n[CACHE_DIR]/\n├── models--[ORGANIZATION]--[MODEL_NAME]/\n│   ├── files_metadata.json\n│   ├── model_file.onnx\n│   ├── config.json\n│   ├── tokenizer.json\n│   └── ...\n├── fast-[MODEL_NAME]/\n│   ├── model_file.onnx\n│   ├── config.json\n│   └── ...\n└── tmp/\n    └── (temporary files during download)\n```\n\nThe cache directory location is determined using the `define_cache_dir()` function, which checks:\n\n1. The `cache_dir` parameter provided to the embedding class\n2. The `FASTEMBED_CACHE_PATH` environment variable\n3. A default location in the system temporary directory\n\nSources: [fastembed/common/utils.py48-59](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/utils.py#L48-L59) [fastembed/common/model\\_management.py327-375](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L327-L375)\n\n## Verification Process\n\nTo ensure model integrity, FastEmbed verifies downloaded files against metadata:\n\n```\n```\n\nThe verification process checks:\n\n1. File existence\n2. File sizes\n3. Blob IDs (when online verification is possible)\n\nThis ensures that all model files are complete and uncorrupted.\n\nSources: [fastembed/common/model\\_management.py152-202](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L152-L202)\n\n## Model Description and Management\n\nModels in FastEmbed are represented by description objects that inherit from `BaseModelDescription`:\n\n```\n```\n\nThese descriptions contain all necessary information to identify, download, and use a model, including:\n\n- Model identifier\n- Source locations (HuggingFace, GCS URL)\n- File names\n- Licensing information\n- Size information\n\nSources: [fastembed/common/model\\_management.py377-402](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L377-L402)\n\n## Implementation Details",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_fastembed\\_qdrant_fastembed_4.1-model-management.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 1019,
      "character_count": 4461,
      "created_at": "2025-10-16T17:42:30.090789",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_fastembed",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "Qdrant\\qdrant_fastembed\\_qdrant_fastembed_4.1-model-management.md",
      "collection_context": "Qdrant/qdrant_fastembed"
    }
  },
  {
    "text": "The `ModelManagement` class is implemented as a generic class parameterized by a type variable `T` that extends `BaseModelDescription`. This allows different embedding classes to use specialized model descriptions while sharing common functionality.\n\n```\n```\n\nKey methods in `ModelManagement` include:\n\n1. `download_model()`: Main entry point for retrieving models\n2. `download_files_from_huggingface()`: Specialized for HuggingFace downloads\n3. `retrieve_model_gcs()`: Specialized for Google Cloud Storage downloads\n4. `_verify_files_from_metadata()`: Verifies downloaded files\n5. `_collect_file_metadata()`: Collects metadata for verification\n\nEach embedding class extends `ModelManagement` with specific type parameters and implementations of abstract methods like `_list_supported_models()`.\n\nSources: [fastembed/common/model\\_management.py24-67](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L24-L67) [fastembed/text/text\\_embedding\\_base.py8-19](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/text/text_embedding_base.py#L8-L19)\n\n## Error Handling and Retry Mechanism\n\nFastEmbed implements a robust retry mechanism for model downloads:\n\n1. First tries HuggingFace if available\n2. Falls back to Google Cloud Storage if HuggingFace fails\n3. Implements exponential backoff between retries\n4. Provides detailed error messages for troubleshooting\n\nThis ensures maximum availability even in case of temporary issues with one source.\n\nSources: [fastembed/common/model\\_management.py412-458](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L412-L458)\n\n## Summary\n\nThe Model Management system in FastEmbed provides a comprehensive solution for handling embedding models through their lifecycle:\n\n1. **Model Retrieval**: Downloads models from multiple sources\n2. **Caching**: Stores models locally to improve performance\n3. **Verification**: Ensures model integrity\n4. **Abstraction**: Provides a unified interface for all embedding types\n\nThis system is a key component that enables FastEmbed to offer high-performance embeddings while maintaining a simple, user-friendly API.\n\nSources: [fastembed/common/model\\_management.py24-458](https://github.com/qdrant/fastembed/blob/b785640b/fastembed/common/model_management.py#L24-L458)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [Model Management](#model-management.md)\n- [Overview](#overview.md)\n- [Architecture](#architecture.md)\n- [Model Sources and Retrieval](#model-sources-and-retrieval.md)\n- [HuggingFace Download Process](#huggingface-download-process.md)\n- [Google Cloud Storage Download Process](#google-cloud-storage-download-process.md)\n- [Caching Mechanism](#caching-mechanism.md)\n- [Cache Directory Structure](#cache-directory-structure.md)\n- [Verification Process](#verification-process.md)\n- [Model Description and Management](#model-description-and-management.md)\n- [Implementation Details](#implementation-details.md)\n- [Error Handling and Retry Mechanism](#error-handling-and-retry-mechanism.md)\n- [Summary](#summary.md)",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_fastembed\\_qdrant_fastembed_4.1-model-management.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 674,
      "character_count": 3103,
      "created_at": "2025-10-16T17:42:30.093860",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_fastembed",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "Qdrant\\qdrant_fastembed\\_qdrant_fastembed_4.1-model-management.md",
      "collection_context": "Qdrant/qdrant_fastembed"
    }
  }
]