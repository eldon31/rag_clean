[
  {
    "text": "Local Inference | qdrant/qdrant-client | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[qdrant/qdrant-client](https://github.com/qdrant/qdrant-client \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 9 July 2025 ([ac6f6c](https://github.com/qdrant/qdrant-client/commits/ac6f6cd2))\n\n- [Overview](qdrant/qdrant-client/1-overview.md)\n- [Client Architecture](qdrant/qdrant-client/2-client-architecture.md)\n- [Client Interface](qdrant/qdrant-client/2.1-client-interface.md)\n- [Local Mode](qdrant/qdrant-client/2.2-local-mode.md)\n- [Remote Mode](qdrant/qdrant-client/2.3-remote-mode.md)\n- [Protocol Handling](qdrant/qdrant-client/2.4-protocol-handling.md)\n- [Core Operations](qdrant/qdrant-client/3-core-operations.md)\n- [Search Operations](qdrant/qdrant-client/3.1-search-operations.md)\n- [Collection Management](qdrant/qdrant-client/3.2-collection-management.md)\n- [Point Operations](qdrant/qdrant-client/3.3-point-operations.md)\n- [Advanced Features](qdrant/qdrant-client/4-advanced-features.md)\n- [FastEmbed Integration](qdrant/qdrant-client/4.1-fastembed-integration.md)\n- [Batch Operations](qdrant/qdrant-client/4.2-batch-operations.md)\n- [Hybrid Search](qdrant/qdrant-client/4.3-hybrid-search.md)\n- [Local Inference](qdrant/qdrant-client/4.4-local-inference.md)\n- [Implementation Details](qdrant/qdrant-client/5-implementation-details.md)\n- [Payload Filtering](qdrant/qdrant-client/5.1-payload-filtering.md)\n- [Type Inspector System](qdrant/qdrant-client/5.2-type-inspector-system.md)\n- [Expression Evaluation](qdrant/qdrant-client/5.3-expression-evaluation.md)\n- [Development & Testing](qdrant/qdrant-client/6-development-and-testing.md)\n- [Project Setup](qdrant/qdrant-client/6.1-project-setup.md)\n- [Testing Framework](qdrant/qdrant-client/6.2-testing-framework.md)\n- [Documentation System](qdrant/qdrant-client/6.3-documentation-system.md)\n\nMenu\n\n# Local Inference\n\nRelevant source files\n\n- [qdrant\\_client/embed/common.py](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/common.py)\n- [qdrant\\_client/embed/embedder.py](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py)\n- [qdrant\\_client/embed/model\\_embedder.py](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py)\n- [qdrant\\_client/fastembed\\_common.py](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/fastembed_common.py)\n- [tests/embed\\_tests/test\\_local\\_inference.py](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py)\n\n## Purpose and Scope\n\nThis document describes the Local Inference system in qdrant-client, which enables automatic embedding of documents and images directly within the client application, without requiring an external embedding service. This system allows seamless integration of embedding models into vector search workflows by automatically detecting and processing objects that require inference.\n\nFor information about the FastEmbed integration, which provides pre-configured models, see [FastEmbed Integration](qdrant/qdrant-client/4.1-fastembed-integration.md).\n\n## Overview\n\nThe Local Inference system transparently converts high-level objects like text documents and images into vector embeddings that can be stored and searched in Qdrant. When you provide a `Document` or `Image` object to methods like `upsert()` or `query_points()`, the system automatically:\n\n1. Detects fields requiring embedding\n2. Loads the appropriate model\n3. Generates embeddings\n4. Replaces the original objects with their vector representations\n\n**Local Inference System Architecture**\n\n```\n```",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 1014,
      "character_count": 3752,
      "created_at": "2025-10-16T17:42:32.540645",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_qdrant-client",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "collection_context": "Qdrant/qdrant_qdrant-client"
    }
  },
  {
    "text": "Sources: [qdrant\\_client/embed/model\\_embedder.py42-444](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L42-L444) [qdrant\\_client/embed/embedder.py29-388](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L29-L388) [qdrant\\_client/fastembed\\_common.py36-267](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/fastembed_common.py#L36-L267)\n\n## Core Components\n\n### ModelEmbedder\n\nThe `ModelEmbedder` class is the primary entry point for local inference. It coordinates the inspection, batching, and embedding processes:\n\n**Core Classes and Methods**\n\n```\n```\n\nSources: [qdrant\\_client/embed/model\\_embedder.py21-444](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L21-L444) [qdrant\\_client/embed/embedder.py23-388](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L23-L388) [qdrant\\_client/fastembed\\_common.py36-267](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/fastembed_common.py#L36-L267)\n\n### Embedder\n\nThe `Embedder` class manages embedding models and performs the actual inference:\n\n- Maintains a registry of initialized models\n- Provides methods to embed text and images\n- Supports various model types (dense, sparse, late interaction, multimodal)\n- Handles model sharing and caching\n\nSources: [qdrant\\_client/embed/embedder.py32-385](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L32-L385)\n\n### Type Inspection System\n\nThe type inspection system identifies fields in models that require inference:\n\n```\n```\n\nSources: [qdrant\\_client/embed/type\\_inspector.py12-149](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/type_inspector.py#L12-L149) [qdrant\\_client/embed/embed\\_inspector.py13-176](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embed_inspector.py#L13-L176) [qdrant\\_client/embed/schema\\_parser.py29-305](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/schema_parser.py#L29-L305)\n\n## Inference Workflow\n\n**Local Inference Processing Flow**\n\n```\n```\n\nSources: [qdrant\\_client/embed/model\\_embedder.py124-156](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L124-L156) [qdrant\\_client/embed/embedder.py222-267](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L222-L267) [tests/embed\\_tests/test\\_local\\_inference.py133-237](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L133-L237)\n\n## Supported Model Types\n\nThe Local Inference system supports several types of embedding models:\n\n| Model Type                  | Description                                 | Input Type     |\n| --------------------------- | ------------------------------------------- | -------------- |\n| Dense Text                  | Standard text embedding models              | Text           |\n| Sparse Text                 | Sparse vector text models                   | Text           |\n| Late Interaction Text       | Models that generate token-level embeddings | Text           |\n| Image                       | Image embedding models                      | Images         |\n| Late Interaction Multimodal | Models that can embed both text and images  | Text or Images |\n\nSources: [qdrant\\_client/fastembed\\_common.py28-78](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/fastembed_common.py#L28-L78)\n\n## Supported Inference Objects\n\n**Inference Object Types**\n\n```\n```\n\nThe constant `INFERENCE_OBJECT_NAMES` contains the string names: `{\"Document\", \"Image\", \"InferenceObject\"}` and `INFERENCE_OBJECT_TYPES` is a Union type used throughout the system for type checking.",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 997,
      "character_count": 3832,
      "created_at": "2025-10-16T17:42:32.546729",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_qdrant-client",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "collection_context": "Qdrant/qdrant_qdrant-client"
    }
  },
  {
    "text": "Sources: [qdrant\\_client/embed/common.py5-6](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/common.py#L5-L6)\n\n## Using Local Inference\n\n### Basic Usage\n\nLocal inference happens automatically when you provide `Document` or `Image` objects to client methods:\n\n```\n```\n\nSources: [tests/embed\\_tests/test\\_local\\_inference.py133-165](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L133-L165)\n\n### Named Vectors\n\nYou can also use local inference with named vectors:\n\n```\n```\n\nSources: [tests/embed\\_tests/test\\_local\\_inference.py166-237](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L166-L237)\n\n### Query-Time Inference\n\nThe system distinguishes between document and query embedding for models that have different embedding methods for documents and queries:\n\n```\n```\n\nSources: [qdrant\\_client/embed/embedder.py278-287](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L278-L287) [tests/embed\\_tests/test\\_local\\_inference.py352-581](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L352-L581)\n\n## Advanced Features\n\n### Model Configuration Options\n\nYou can pass additional options to the embedding models:\n\n```\n```\n\nSources: [qdrant\\_client/embed/embedder.py61-67](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L61-L67) [tests/embed\\_tests/test\\_local\\_inference.py916-976](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L916-L976)\n\n### Parallel Processing\n\nFor large batches of documents, you can use parallel processing:\n\n```\n```\n\nSources: [qdrant\\_client/embed/model\\_embedder.py75-123](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L75-L123) [tests/embed\\_tests/test\\_local\\_inference.py310-350](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L310-L350)\n\n## Integration with Client Operations\n\nLocal inference is integrated with various client operations:",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 578,
      "character_count": 2151,
      "created_at": "2025-10-16T17:42:32.549784",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_qdrant-client",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "collection_context": "Qdrant/qdrant_qdrant-client"
    }
  },
  {
    "text": "| Operation             | Description                                              | Test Coverage                                                                                                                                                    |\n| --------------------- | -------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `upsert`              | Embeds documents/images before upserting                 | [tests/embed\\_tests/test\\_local\\_inference.py133-237](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L133-L237) |\n| `upload_points`       | Embeds documents/images when uploading points in batches | [tests/embed\\_tests/test\\_local\\_inference.py240-350](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L240-L350) |\n| `upload_collection`   | Embeds vectors when uploading a collection               | [tests/embed\\_tests/test\\_local\\_inference.py295-350](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L295-L350) |\n| `query_points`        | Embeds query documents/images before searching           | [tests/embed\\_tests/test\\_local\\_inference.py352-515](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L352-L515) |\n| `query_points_groups` | Embeds query documents/images for grouped searches       | [tests/embed\\_tests/test\\_local\\_inference.py584-682](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L584-L682) |\n| `query_batch_points`  | Embeds documents/images in batch queries                 | [tests/embed\\_tests/test\\_local\\_inference.py684-743](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L684-L743) |\n| `batch_update_points` | Embeds documents/images in batch updates                 | [tests/embed\\_tests/test\\_local\\_inference.py745-857](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L745-L857) |\n| `update_vectors`      | Embeds new documents/images when updating vectors        | [tests/embed\\_tests/test\\_local\\_inference.py859-914](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L859-L914) |\n\nSources: [tests/embed\\_tests/test\\_local\\_inference.py133-914](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L133-L914)\n\n## Internal Architecture\n\n### Object Detection and Processing\n\nThe system uses a multi-step process to detect and process objects requiring inference:\n\n1. **Model Processing**: The `ModelEmbedder._process_model()` method traverses model structures to find inference objects.\n2. **Object Accumulation**: The `_accumulate()` method collects `Document`, `Image`, and `InferenceObject` instances into batches grouped by model name.\n3. **Batch Embedding**: The `_embed_accumulator()` method calls `Embedder.embed()` to generate embeddings for accumulated objects.\n4. **Model Resolution**: The `_resolve_inference_object()` method converts `InferenceObject` instances to `Document` or `Image` objects.\n5. **Replacement**: The `_drain_accumulator()` method replaces original objects with their vector representations.\n\n**Processing Pipeline**\n\n```\n```\n\nSources: [qdrant\\_client/embed/model\\_embedder.py141-156](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L141-L156) [qdrant\\_client/embed/model\\_embedder.py247-275](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L247-L275) [qdrant\\_client/embed/model\\_embedder.py277-317](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/model_embedder.py#L277-L317)\n\n### Model Management\n\nThe `Embedder` class efficiently manages embedding models through `ModelInstance` containers:",
    "metadata": {
      "chunk_id": 3,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 937,
      "character_count": 4079,
      "created_at": "2025-10-16T17:42:32.553870",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_qdrant-client",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 3,
      "file_relative_path": "Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "collection_context": "Qdrant/qdrant_qdrant-client"
    }
  },
  {
    "text": "- **Model Caching**: Each model type has its own dictionary (e.g., `embedding_models`, `sparse_embedding_models`) storing lists of `ModelInstance[T]` objects\n- **Configuration Tracking**: `ModelInstance` objects store model instances with their initialization options and deprecation status\n- **Lazy Loading**: Models are loaded only when first requested via `get_or_init_*` methods\n- **Option Matching**: Multiple instances of the same model with different configurations are supported by comparing options dictionaries\n- **Model Validation**: `FastEmbedMisc` provides validation methods for all supported model types\n\n**Model Instance Management**\n\n```\n```\n\nSources: [qdrant\\_client/embed/embedder.py23-27](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L23-L27) [qdrant\\_client/embed/embedder.py29-44](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L29-L44) [qdrant\\_client/embed/embedder.py46-221](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/embed/embedder.py#L46-L221)\n\n## Compatibility\n\nThe Local Inference system is designed to work with:\n\n- **Local in-memory Qdrant instances**: `QdrantClient(\":memory:\")`\n- **Local persistent Qdrant instances**: `QdrantClient(path=\"/path/to/db\")`\n- **Remote Qdrant servers**: `QdrantClient(host=\"localhost\", port=6333)`\n\nThe system automatically handles embedding generation regardless of the backend, with the same API working across all deployment modes.\n\nSources: [tests/embed\\_tests/test\\_local\\_inference.py134](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L134-L134) [tests/embed\\_tests/test\\_local\\_inference.py256-259](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L256-L259)\n\n## Limitations\n\n- The FastEmbed library must be installed to use Local Inference\n- Not all embedding models are supported, only those available in FastEmbed\n- Embedding large batches may require significant memory\n\nSources: [tests/embed\\_tests/test\\_local\\_inference.py134-136](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/tests/embed_tests/test_local_inference.py#L134-L136) [qdrant\\_client/fastembed\\_common.py8-25](https://github.com/qdrant/qdrant-client/blob/ac6f6cd2/qdrant_client/fastembed_common.py#L8-L25)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [Local Inference](#local-inference.md)\n- [Purpose and Scope](#purpose-and-scope.md)\n- [Overview](#overview.md)\n- [Core Components](#core-components.md)\n- [ModelEmbedder](#modelembedder.md)\n- [Embedder](#embedder.md)\n- [Type Inspection System](#type-inspection-system.md)\n- [Inference Workflow](#inference-workflow.md)\n- [Supported Model Types](#supported-model-types.md)\n- [Supported Inference Objects](#supported-inference-objects.md)\n- [Using Local Inference](#using-local-inference.md)\n- [Basic Usage](#basic-usage.md)\n- [Named Vectors](#named-vectors.md)\n- [Query-Time Inference](#query-time-inference.md)\n- [Advanced Features](#advanced-features.md)\n- [Model Configuration Options](#model-configuration-options.md)\n- [Parallel Processing](#parallel-processing.md)\n- [Integration with Client Operations](#integration-with-client-operations.md)\n- [Internal Architecture](#internal-architecture.md)\n- [Object Detection and Processing](#object-detection-and-processing.md)\n- [Model Management](#model-management.md)\n- [Compatibility](#compatibility.md)\n- [Limitations](#limitations.md)",
    "metadata": {
      "chunk_id": 4,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "input_type": "qdrant",
      "chunking_strategy": "platform_documentation",
      "token_count": 892,
      "character_count": 3513,
      "created_at": "2025-10-16T17:42:32.556966",
      "parent_context": null,
      "semantic_type": "qdrant",
      "collection_name": "Qdrant",
      "subfolder_name": "qdrant_qdrant-client",
      "collection_strategy": "platform_documentation",
      "chunk_index_in_file": 4,
      "file_relative_path": "Qdrant\\qdrant_qdrant-client\\_qdrant_qdrant-client_4.4-local-inference.md",
      "collection_context": "Qdrant/qdrant_qdrant-client"
    }
  }
]