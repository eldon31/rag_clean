[
  {
    "text": "Client Authentication | jlowin/fastmcp | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[jlowin/fastmcp](https://github.com/jlowin/fastmcp \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 30 September 2025 ([66221e](https://github.com/jlowin/fastmcp/commits/66221ed3))\n\n- [FastMCP Overview](jlowin/fastmcp/1-fastmcp-overview.md)\n- [Installation and Setup](jlowin/fastmcp/1.1-installation-and-setup.md)\n- [FastMCP Server Core](jlowin/fastmcp/2-fastmcp-server-core.md)\n- [Component System Architecture](jlowin/fastmcp/2.1-component-system-architecture.md)\n- [Context System and Dependencies](jlowin/fastmcp/2.2-context-system-and-dependencies.md)\n- [Server Composition and Proxying](jlowin/fastmcp/2.3-server-composition-and-proxying.md)\n- [FastMCP Client System](jlowin/fastmcp/3-fastmcp-client-system.md)\n- [Transport Mechanisms](jlowin/fastmcp/3.1-transport-mechanisms.md)\n- [Client Authentication](jlowin/fastmcp/3.2-client-authentication.md)\n- [HTTP Server and Deployment](jlowin/fastmcp/4-http-server-and-deployment.md)\n- [Authentication and Security](jlowin/fastmcp/4.1-authentication-and-security.md)\n- [Middleware System](jlowin/fastmcp/4.2-middleware-system.md)\n- [Command Line Interface](jlowin/fastmcp/5-command-line-interface.md)\n- [OpenAPI Integration](jlowin/fastmcp/6-openapi-integration.md)\n- [Configuration Management](jlowin/fastmcp/7-configuration-management.md)\n- [Testing and Development Framework](jlowin/fastmcp/8-testing-and-development-framework.md)\n- [Project Infrastructure](jlowin/fastmcp/9-project-infrastructure.md)\n- [Documentation and Updates](jlowin/fastmcp/10-documentation-and-updates.md)\n\nMenu\n\n# Client Authentication\n\nRelevant source files\n\n- [docs/integrations/auth0.mdx](https://github.com/jlowin/fastmcp/blob/66221ed3/docs/integrations/auth0.mdx)\n- [src/fastmcp/client/auth/oauth.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py)\n- [src/fastmcp/server/auth/oidc\\_proxy.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oidc_proxy.py)\n- [src/fastmcp/server/auth/providers/auth0.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/auth0.py)\n- [tests/client/auth/test\\_oauth\\_token\\_expiry.py](https://github.com/jlowin/fastmcp/blob/66221ed3/tests/client/auth/test_oauth_token_expiry.py)\n- [tests/server/auth/providers/test\\_auth0.py](https://github.com/jlowin/fastmcp/blob/66221ed3/tests/server/auth/providers/test_auth0.py)\n- [tests/server/auth/test\\_oidc\\_proxy.py](https://github.com/jlowin/fastmcp/blob/66221ed3/tests/server/auth/test_oidc_proxy.py)\n\nThis page covers client-side authentication in FastMCP, focusing on OAuth flows, token storage, browser-based authentication, and integration with identity providers. This documentation explains how FastMCP clients authenticate with protected servers using industry-standard OAuth 2.0 and OpenID Connect protocols.\n\nFor server-side authentication configuration and identity providers, see [Authentication and Security](jlowin/fastmcp/4.1-authentication-and-security.md). For transport-specific authentication mechanisms, see [Transport Mechanisms](jlowin/fastmcp/3.1-transport-mechanisms.md).\n\n## Overview\n\nFastMCP client authentication is built around OAuth 2.0 with OpenID Connect support, providing secure token-based authentication for MCP clients connecting to protected servers. The authentication system handles the complete OAuth flow, from initial authorization to token refresh and storage.\n\n### Client Authentication Architecture\n\n```\n```",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 960,
      "character_count": 3658,
      "created_at": "2025-10-16T17:42:18.938808",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  },
  {
    "text": "Sources: [src/fastmcp/client/auth/oauth.py242-428](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L242-L428) [src/fastmcp/client/oauth\\_callback.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/oauth_callback.py) [src/fastmcp/utilities/storage.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/utilities/storage.py)\n\n## OAuth Flow Implementation\n\nThe `OAuth` class implements the complete OAuth 2.0 authorization code flow with PKCE support, handling dynamic client registration, browser-based authorization, and token management.\n\n### OAuth Provider Class Structure\n\n```\n```\n\nSources: [src/fastmcp/client/auth/oauth.py242-311](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L242-L311) [src/fastmcp/client/auth/oauth.py322-374](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L322-L374) [src/fastmcp/client/auth/oauth.py376-427](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L376-L427)\n\n### Authorization Flow Process\n\nThe OAuth authorization flow follows these steps:\n\n| Step | Method               | Description                          | Error Handling                          |\n| ---- | -------------------- | ------------------------------------ | --------------------------------------- |\n| 1    | `redirect_handler()` | Pre-flight validation, opens browser | Detects stale client\\_id (400 response) |\n| 2    | `callback_handler()` | Starts local callback server         | 5-minute timeout with graceful shutdown |\n| 3    | Token Exchange       | Exchanges auth code for tokens       | Automatic retry on client errors        |\n| 4    | Token Storage        | Saves tokens with absolute expiry    | Validates token format and expiry       |\n\nSources: [src/fastmcp/client/auth/oauth.py322-341](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L322-L341) [src/fastmcp/client/auth/oauth.py343-374](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L343-L374)\n\n## Token Storage and Management\n\nFastMCP implements sophisticated token storage with automatic expiry handling, server isolation, and format validation through the `FileTokenStorage` class.\n\n### Token Storage Architecture\n\n```\n```\n\nSources: [src/fastmcp/client/auth/oauth.py59-196](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L59-L196) [src/fastmcp/client/auth/oauth.py44-52](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L44-L52)\n\n### Token Expiry Handling\n\nThe token storage system uses absolute timestamps rather than relative `expires_in` values to ensure accurate expiry checking across application restarts:\n\n```\n```\n\nSources: [src/fastmcp/client/auth/oauth.py132-147](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L132-L147) [src/fastmcp/client/auth/oauth.py96-130](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L96-L130) [tests/client/auth/test\\_oauth\\_token\\_expiry.py13-164](https://github.com/jlowin/fastmcp/blob/66221ed3/tests/client/auth/test_oauth_token_expiry.py#L13-L164)\n\n## Browser-Based Authentication\n\nFastMCP uses a browser-based OAuth flow that opens the user's default browser for authorization and runs a temporary local server to receive the OAuth callback.\n\n### Browser Flow Implementation\n\n```\n```\n\nSources: [src/fastmcp/client/auth/oauth.py322-341](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L322-L341) [src/fastmcp/client/auth/oauth.py343-374](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L343-L374) [src/fastmcp/client/auth/oauth.py395-427](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L395-L427)\n\n### Callback Server Configuration\n\nThe OAuth callback server uses dynamic port allocation and graceful shutdown:",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1011,
      "character_count": 3991,
      "created_at": "2025-10-16T17:42:18.945448",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  },
  {
    "text": "| Configuration | Default                            | Description                              |\n| ------------- | ---------------------------------- | ---------------------------------------- |\n| Port          | `find_available_port()`            | Dynamically allocated available port     |\n| Timeout       | 300 seconds                        | Maximum wait time for user authorization |\n| Redirect URI  | `http://localhost:{port}/callback` | OAuth callback endpoint                  |\n| Server Type   | `uvicorn.Server`                   | ASGI server for handling callbacks       |\n\nSources: [src/fastmcp/client/auth/oauth.py275-276](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L275-L276) [src/fastmcp/utilities/http.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/utilities/http.py) [src/fastmcp/client/oauth\\_callback.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/oauth_callback.py)\n\n## Identity Provider Integration\n\nFastMCP supports multiple identity providers through standardized OAuth 2.0 and OpenID Connect protocols. The authentication system is provider-agnostic, requiring only standard OAuth endpoints.\n\n### Provider Configuration\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oidc\\_proxy.py27-169](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oidc_proxy.py#L27-L169) [src/fastmcp/server/auth/providers/auth0.py36-175](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/auth0.py#L36-L175)\n\n### Authentication Pre-flight Check\n\nBefore initiating OAuth flows, FastMCP can check if authentication is required:\n\n```\n```\n\nThis function tests the endpoint and returns `True` if authentication appears required based on HTTP status codes (401, 403) or WWW-Authenticate headers.\n\nSources: [src/fastmcp/client/auth/oauth.py212-240](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L212-L240)\n\n## Configuration and Usage\n\n### Basic OAuth Configuration\n\n```\n```\n\n### Client Integration\n\n```\n```\n\n### Token Storage Locations\n\nThe `FileTokenStorage` class stores tokens in server-specific files:\n\n| File Type   | Path Pattern                         | Purpose                           |\n| ----------- | ------------------------------------ | --------------------------------- |\n| Tokens      | `{base_url}_tokens.json`             | Access/refresh tokens with expiry |\n| Client Info | `{base_url}_client_info.json`        | OAuth client registration data    |\n| Cache Dir   | `~/.fastmcp/oauth-mcp-client-cache/` | Default storage location          |\n\nSources: [src/fastmcp/client/auth/oauth.py250-311](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L250-L311) [src/fastmcp/client/auth/oauth.py55-86](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L55-L86)\n\n### Error Handling and Recovery\n\nThe OAuth implementation includes automatic error recovery:\n\n- **Stale Credentials**: Detects invalid client\\_id and clears cache for retry\n- **Token Expiry**: Automatically refreshes expired tokens\n- **Network Errors**: Graceful handling of connection issues\n- **Timeout Handling**: 5-minute timeout with user-friendly messages\n\nSources: [src/fastmcp/client/auth/oauth.py376-427](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L376-L427) [src/fastmcp/client/auth/oauth.py38-41](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/client/auth/oauth.py#L38-L41)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 842,
      "character_count": 3603,
      "created_at": "2025-10-16T17:42:18.951787",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  },
  {
    "text": "- [Client Authentication](#client-authentication.md)\n- [Overview](#overview.md)\n- [Client Authentication Architecture](#client-authentication-architecture.md)\n- [OAuth Flow Implementation](#oauth-flow-implementation.md)\n- [OAuth Provider Class Structure](#oauth-provider-class-structure.md)\n- [Authorization Flow Process](#authorization-flow-process.md)\n- [Token Storage and Management](#token-storage-and-management.md)\n- [Token Storage Architecture](#token-storage-architecture.md)\n- [Token Expiry Handling](#token-expiry-handling.md)\n- [Browser-Based Authentication](#browser-based-authentication.md)\n- [Browser Flow Implementation](#browser-flow-implementation.md)\n- [Callback Server Configuration](#callback-server-configuration.md)\n- [Identity Provider Integration](#identity-provider-integration.md)\n- [Provider Configuration](#provider-configuration.md)\n- [Authentication Pre-flight Check](#authentication-pre-flight-check.md)\n- [Configuration and Usage](#configuration-and-usage.md)\n- [Basic OAuth Configuration](#basic-oauth-configuration.md)\n- [Client Integration](#client-integration.md)\n- [Token Storage Locations](#token-storage-locations.md)\n- [Error Handling and Recovery](#error-handling-and-recovery.md)",
    "metadata": {
      "chunk_id": 3,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 259,
      "character_count": 1221,
      "created_at": "2025-10-16T17:42:18.951898",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 3,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_3.2-client-authentication.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  }
]