[
  {
    "text": "Authentication and Security | jlowin/fastmcp | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[jlowin/fastmcp](https://github.com/jlowin/fastmcp \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 30 September 2025 ([66221e](https://github.com/jlowin/fastmcp/commits/66221ed3))\n\n- [FastMCP Overview](jlowin/fastmcp/1-fastmcp-overview.md)\n- [Installation and Setup](jlowin/fastmcp/1.1-installation-and-setup.md)\n- [FastMCP Server Core](jlowin/fastmcp/2-fastmcp-server-core.md)\n- [Component System Architecture](jlowin/fastmcp/2.1-component-system-architecture.md)\n- [Context System and Dependencies](jlowin/fastmcp/2.2-context-system-and-dependencies.md)\n- [Server Composition and Proxying](jlowin/fastmcp/2.3-server-composition-and-proxying.md)\n- [FastMCP Client System](jlowin/fastmcp/3-fastmcp-client-system.md)\n- [Transport Mechanisms](jlowin/fastmcp/3.1-transport-mechanisms.md)\n- [Client Authentication](jlowin/fastmcp/3.2-client-authentication.md)\n- [HTTP Server and Deployment](jlowin/fastmcp/4-http-server-and-deployment.md)\n- [Authentication and Security](jlowin/fastmcp/4.1-authentication-and-security.md)\n- [Middleware System](jlowin/fastmcp/4.2-middleware-system.md)\n- [Command Line Interface](jlowin/fastmcp/5-command-line-interface.md)\n- [OpenAPI Integration](jlowin/fastmcp/6-openapi-integration.md)\n- [Configuration Management](jlowin/fastmcp/7-configuration-management.md)\n- [Testing and Development Framework](jlowin/fastmcp/8-testing-and-development-framework.md)\n- [Project Infrastructure](jlowin/fastmcp/9-project-infrastructure.md)\n- [Documentation and Updates](jlowin/fastmcp/10-documentation-and-updates.md)\n\nMenu\n\n# Authentication and Security\n\nRelevant source files\n\n- [docs/servers/auth/oauth-proxy.mdx](https://github.com/jlowin/fastmcp/blob/66221ed3/docs/servers/auth/oauth-proxy.mdx)\n- [src/fastmcp/server/auth/oauth\\_proxy.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py)\n- [src/fastmcp/server/auth/providers/azure.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/azure.py)\n- [src/fastmcp/server/auth/providers/github.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/github.py)\n- [src/fastmcp/server/auth/providers/google.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/google.py)\n- [src/fastmcp/server/auth/providers/workos.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/workos.py)\n- [src/fastmcp/utilities/storage.py](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/utilities/storage.py)\n- [tests/server/auth/test\\_oauth\\_proxy.py](https://github.com/jlowin/fastmcp/blob/66221ed3/tests/server/auth/test_oauth_proxy.py)\n\nThis document covers FastMCP's comprehensive authentication and security system, including OAuth integration, token verification, and security mechanisms. The system enables FastMCP servers to authenticate with traditional OAuth providers (GitHub, Google, Azure, etc.) while maintaining compatibility with MCP's Dynamic Client Registration requirements.\n\nFor HTTP server deployment patterns, see [HTTP Server and Deployment](jlowin/fastmcp/4-http-server-and-deployment.md). For middleware-based security features like rate limiting and request validation, see [Middleware System](jlowin/fastmcp/4.2-middleware-system.md).\n\n## Architecture Overview\n\nFastMCP's authentication system centers around the **OAuth Proxy** pattern, which bridges the gap between traditional OAuth providers (that require pre-registered applications) and MCP clients (that expect Dynamic Client Registration). The system consists of several key components working together to provide secure, transparent authentication.\n\n### Core Authentication Flow\n\n```\n```",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_4.1-authentication-and-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1005,
      "character_count": 3909,
      "created_at": "2025-10-16T17:42:18.977610",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_4.1-authentication-and-security.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  },
  {
    "text": "Sources: [src/fastmcp/server/auth/oauth\\_proxy.py125-231](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L125-L231) [src/fastmcp/server/auth/providers/github.py167-193](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/github.py#L167-L193) [src/fastmcp/server/auth/providers/google.py183-209](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/google.py#L183-L209)\n\n## OAuth Proxy System\n\nThe `OAuthProxy` class is the cornerstone of FastMCP's authentication system, implementing a transparent proxy that presents a DCR-compliant interface to MCP clients while using pre-registered credentials with upstream OAuth providers.\n\n### OAuth Proxy Architecture\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oauth\\_proxy.py125-371](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L125-L371) [src/fastmcp/server/auth/oauth\\_proxy.py464-559](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L464-L559)\n\n### Dynamic Client Registration Implementation\n\nThe proxy implements local DCR through the `ProxyDCRClient` class, which validates redirect URIs against configurable patterns while maintaining compatibility with upstream providers that only accept fixed redirect URIs.\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oauth\\_proxy.py60-115](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L60-L115) [src/fastmcp/server/auth/oauth\\_proxy.py396-459](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L396-L459)\n\n### Authorization Code Exchange\n\nThe proxy implements a dual-layer authorization flow that maintains security while bridging DCR requirements with traditional OAuth constraints.\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oauth\\_proxy.py464-669](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L464-L669) [src/fastmcp/server/auth/oauth\\_proxy.py876-1061](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L876-L1061)\n\n## Token Verification System\n\nFastMCP supports multiple token verification strategies through the `TokenVerifier` base class and provider-specific implementations that handle different token formats and validation mechanisms.\n\n### Token Verifier Architecture\n\n```\n```\n\nSources: [src/fastmcp/server/auth/providers/jwt.py1-200](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/jwt.py#L1-L200) [src/fastmcp/server/auth/providers/github.py62-165](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/github.py#L62-L165) [src/fastmcp/server/auth/providers/google.py64-181](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/google.py#L64-L181)\n\n### Access Token Structure\n\nThe `AccessToken` class provides a unified representation of validated tokens across all providers:\n\n```\n```\n\nSources: [src/fastmcp/server/auth/auth.py50-85](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/auth.py#L50-L85) [src/fastmcp/server/auth/providers/github.py144-157](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/github.py#L144-L157) [src/fastmcp/server/auth/providers/google.py152-173](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/google.py#L152-L173)\n\n## Built-in Provider Implementations\n\nFastMCP includes ready-to-use provider implementations for major OAuth services, each handling provider-specific requirements and token formats.\n\n### Provider Class Hierarchy\n\n```\n```",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_4.1-authentication-and-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 940,
      "character_count": 3689,
      "created_at": "2025-10-16T17:42:18.983894",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_4.1-authentication-and-security.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  },
  {
    "text": "Sources: [src/fastmcp/server/auth/providers/github.py167-284](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/github.py#L167-L284) [src/fastmcp/server/auth/providers/google.py183-303](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/google.py#L183-L303) [src/fastmcp/server/auth/providers/azure.py118-266](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/azure.py#L118-L266) [src/fastmcp/server/auth/providers/workos.py128-262](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/providers/workos.py#L128-L262)\n\n## Security Features\n\nFastMCP implements multiple layers of security to protect OAuth flows and ensure secure token handling.\n\n### PKCE (Proof Key for Code Exchange)\n\nThe proxy implements dual-layer PKCE protection, maintaining security between client-to-proxy and proxy-to-provider connections:\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oauth\\_proxy.py377-391](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L377-L391) [src/fastmcp/server/auth/oauth\\_proxy.py481-530](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L481-L530)\n\n### Redirect URI Validation\n\nThe `ProxyDCRClient` class implements configurable redirect URI validation to prevent authorization code interception while maintaining DCR compatibility:\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oauth\\_proxy.py60-115](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L60-L115) [src/fastmcp/server/auth/redirect\\_validation.py1-50](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/redirect_validation.py#L1-L50)\n\n### Token Management and Revocation\n\nThe proxy maintains comprehensive token lifecycle management with cleanup and revocation capabilities:\n\n```\n```\n\nSources: [src/fastmcp/server/auth/oauth\\_proxy.py775-818](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L775-L818) [src/fastmcp/server/auth/oauth\\_proxy.py674-753](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L674-L753)\n\n## Storage and Persistence\n\nFastMCP provides pluggable storage backends for persisting OAuth client registrations and maintaining session state across server restarts.\n\n### Storage Architecture\n\n```\n```\n\nSources: [src/fastmcp/utilities/storage.py16-205](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/utilities/storage.py#L16-L205) [src/fastmcp/server/auth/oauth\\_proxy.py345-349](https://github.com/jlowin/fastmcp/blob/66221ed3/src/fastmcp/server/auth/oauth_proxy.py#L345-L349)\n\nThe authentication system provides a robust, secure foundation for FastMCP servers while maintaining compatibility with both traditional OAuth providers and MCP's Dynamic Client Registration requirements. The modular design allows for easy extension with new providers and verification methods as needed.\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [Authentication and Security](#authentication-and-security.md)\n- [Architecture Overview](#architecture-overview.md)\n- [Core Authentication Flow](#core-authentication-flow.md)\n- [OAuth Proxy System](#oauth-proxy-system.md)\n- [OAuth Proxy Architecture](#oauth-proxy-architecture.md)\n- [Dynamic Client Registration Implementation](#dynamic-client-registration-implementation.md)\n- [Authorization Code Exchange](#authorization-code-exchange.md)\n- [Token Verification System](#token-verification-system.md)\n- [Token Verifier Architecture](#token-verifier-architecture.md)\n- [Access Token Structure](#access-token-structure.md)\n- [Built-in Provider Implementations](#built-in-provider-implementations.md)\n- [Provider Class Hierarchy](#provider-class-hierarchy.md)\n- [Security Features](#security-features.md)\n- [PKCE (Proof Key for Code Exchange)](#pkce-proof-key-for-code-exchange.md)\n- [Redirect URI Validation](#redirect-uri-validation.md)\n- [Token Management and Revocation](#token-management-and-revocation.md)\n- [Storage and Persistence](#storage-and-persistence.md)\n- [Storage Architecture](#storage-architecture.md)",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_4.1-authentication-and-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1023,
      "character_count": 4190,
      "created_at": "2025-10-16T17:42:18.988994",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "jlowin_fastmcp",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "FAST_DOCS\\jlowin_fastmcp\\_jlowin_fastmcp_4.1-authentication-and-security.md",
      "collection_context": "FAST_DOCS/jlowin_fastmcp"
    }
  }
]