[
  {
    "text": "Dependency Injection | fastapi/fastapi | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[fastapi/fastapi](https://github.com/fastapi/fastapi \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 5 September 2025 ([3e2dbf](https://github.com/fastapi/fastapi/commits/3e2dbf91))\n\n- [FastAPI Overview](fastapi/fastapi/1-fastapi-overview.md)\n- [Core Architecture](fastapi/fastapi/2-core-architecture.md)\n- [Application and Routing System](fastapi/fastapi/2.1-application-and-routing-system.md)\n- [Dependency Injection](fastapi/fastapi/2.2-dependency-injection.md)\n- [Parameter Validation and Handling](fastapi/fastapi/2.3-parameter-validation-and-handling.md)\n- [Response Handling](fastapi/fastapi/2.4-response-handling.md)\n- [Security Components](fastapi/fastapi/2.5-security-components.md)\n- [Settings Management](fastapi/fastapi/2.6-settings-management.md)\n- [Error Handling](fastapi/fastapi/2.7-error-handling.md)\n- [API Documentation System](fastapi/fastapi/3-api-documentation-system.md)\n- [OpenAPI Schema Generation](fastapi/fastapi/3.1-openapi-schema-generation.md)\n- [Customizing API Documentation UI](fastapi/fastapi/3.2-customizing-api-documentation-ui.md)\n- [Advanced Features](fastapi/fastapi/4-advanced-features.md)\n- [Asynchronous Support](fastapi/fastapi/4.1-asynchronous-support.md)\n- [Database Integration](fastapi/fastapi/4.2-database-integration.md)\n- [Background Tasks](fastapi/fastapi/4.3-background-tasks.md)\n- [Deployment and Production Considerations](fastapi/fastapi/4.4-deployment-and-production-considerations.md)\n- [Testing Infrastructure](fastapi/fastapi/5-testing-infrastructure.md)\n- [Test Framework and Tools](fastapi/fastapi/5.1-test-framework-and-tools.md)\n- [Code Quality and Pre-commit](fastapi/fastapi/5.2-code-quality-and-pre-commit.md)\n- [Project Infrastructure](fastapi/fastapi/6-project-infrastructure.md)\n- [Documentation System](fastapi/fastapi/6.1-documentation-system.md)\n- [CI/CD Pipeline](fastapi/fastapi/6.2-cicd-pipeline.md)\n- [Development Workflow](fastapi/fastapi/6.3-development-workflow.md)\n- [Community Ecosystem](fastapi/fastapi/7-community-ecosystem.md)\n- [Contributors and Experts Management](fastapi/fastapi/7.1-contributors-and-experts-management.md)\n- [Translation Management](fastapi/fastapi/7.2-translation-management.md)\n- [External Resources and Sponsorship](fastapi/fastapi/7.3-external-resources-and-sponsorship.md)\n- [Community Automation](fastapi/fastapi/7.4-community-automation.md)\n\nMenu\n\n# Dependency Injection\n\nRelevant source files",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 688,
      "character_count": 2615,
      "created_at": "2025-10-16T17:42:18.071276",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "fastapi_fastapi",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "collection_context": "FAST_DOCS/fastapi_fastapi"
    }
  },
  {
    "text": "- [docs/en/docs/alternatives.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/alternatives.md)\n- [docs/en/docs/tutorial/body.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/body.md)\n- [docs/en/docs/tutorial/dependencies/classes-as-dependencies.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/dependencies/classes-as-dependencies.md)\n- [docs/en/docs/tutorial/dependencies/dependencies-in-path-operation-decorators.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/dependencies/dependencies-in-path-operation-decorators.md)\n- [docs/en/docs/tutorial/dependencies/index.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/dependencies/index.md)\n- [docs/en/docs/tutorial/dependencies/sub-dependencies.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/dependencies/sub-dependencies.md)\n- [docs/en/docs/tutorial/path-params-numeric-validations.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/path-params-numeric-validations.md)\n- [docs/en/docs/tutorial/query-params-str-validations.md](https://github.com/fastapi/fastapi/blob/3e2dbf91/docs/en/docs/tutorial/query-params-str-validations.md)\n- [fastapi/applications.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/applications.py)\n- [fastapi/dependencies/models.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/models.py)\n- [fastapi/dependencies/utils.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py)\n- [fastapi/encoders.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/encoders.py)\n- [fastapi/openapi/constants.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/openapi/constants.py)\n- [fastapi/openapi/models.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/openapi/models.py)\n- [fastapi/openapi/utils.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/openapi/utils.py)\n- [fastapi/param\\_functions.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/param_functions.py)\n- [fastapi/params.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/params.py)\n- [fastapi/routing.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/routing.py)\n- [fastapi/security/api\\_key.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/security/api_key.py)\n- [fastapi/security/http.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/security/http.py)\n- [fastapi/security/oauth2.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/security/oauth2.py)\n- [fastapi/security/open\\_id\\_connect\\_url.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/security/open_id_connect_url.py)\n- [fastapi/utils.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/utils.py)\n- [tests/test\\_datetime\\_custom\\_encoder.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/tests/test_datetime_custom_encoder.py)\n- [tests/test\\_get\\_request\\_body.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/tests/test_get_request_body.py)\n- [tests/test\\_jsonable\\_encoder.py](https://github.com/fastapi/fastapi/blob/3e2dbf91/tests/test_jsonable_encoder.py)\n\nThis document covers FastAPI's dependency injection system, which provides automatic resolution and injection of dependencies into path operation functions. The system analyzes function signatures to identify dependencies, validates parameters, and manages the lifecycle of dependency instances including caching and cleanup.\n\nFor information about parameter validation and handling, see [Parameter Validation and Handling](fastapi/fastapi/2.3-parameter-validation-and-handling.md). For security-specific dependency injection, see [Security Components](fastapi/fastapi/2.5-security-components.md).\n\n## System Architecture",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1004,
      "character_count": 3833,
      "created_at": "2025-10-16T17:42:18.073336",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "fastapi_fastapi",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "collection_context": "FAST_DOCS/fastapi_fastapi"
    }
  },
  {
    "text": "FastAPI's dependency injection system consists of three main components: dependency analysis, dependency resolution, and lifecycle management. The system automatically discovers dependencies through function signature inspection and resolves them recursively during request processing.\n\n### Dependency Injection Architecture\n\n```\n```\n\nSources: [fastapi/routing.py292-299](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/routing.py#L292-L299) [fastapi/dependencies/utils.py572-695](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L572-L695) [fastapi/dependencies/models.py15-37](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/models.py#L15-L37)\n\n## Core Components\n\n### Dependant Model\n\nThe `Dependant` dataclass represents the dependency structure of a function, containing categorized parameters and sub-dependencies. Each dependant tracks parameter types, security requirements, and caching behavior.\n\n| Field                   | Type                        | Purpose                             |\n| ----------------------- | --------------------------- | ----------------------------------- |\n| `path_params`           | `List[ModelField]`          | Path parameter definitions          |\n| `query_params`          | `List[ModelField]`          | Query parameter definitions         |\n| `header_params`         | `List[ModelField]`          | Header parameter definitions        |\n| `cookie_params`         | `List[ModelField]`          | Cookie parameter definitions        |\n| `body_params`           | `List[ModelField]`          | Request body parameter definitions  |\n| `dependencies`          | `List[Dependant]`           | Nested dependency structures        |\n| `security_requirements` | `List[SecurityRequirement]` | Security-related dependencies       |\n| `call`                  | `Optional[Callable]`        | The actual function to call         |\n| `use_cache`             | `bool`                      | Whether to cache dependency results |\n\nSources: [fastapi/dependencies/models.py15-37](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/models.py#L15-L37)\n\n### Depends Mechanism\n\nThe `Depends` class marks function parameters as dependencies, triggering automatic resolution by the dependency injection system.\n\n```\n```\n\nThe `dependency` parameter specifies the callable to invoke, while `use_cache` controls whether results should be cached for the request duration.\n\nSources: [fastapi/params.py1-774](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/params.py#L1-L774)\n\n## Dependency Analysis Process\n\n### Function Signature Analysis\n\nThe `get_dependant` function analyzes function signatures to extract dependency information, categorizing parameters by their types and annotations.\n\n```\n```\n\nSources: [fastapi/dependencies/utils.py265-314](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L265-L314) [fastapi/dependencies/utils.py348-511](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L348-L511)\n\n### Parameter Classification\n\nThe `analyze_param` function classifies function parameters into dependency types based on annotations and default values:\n\n- **Explicit Dependencies**: Parameters with `Depends()` annotations\n- **Request Objects**: `Request`, `WebSocket`, `Response`, `BackgroundTasks` types\n- **Path Parameters**: Parameters matching path template variables\n- **Query Parameters**: Scalar types without special annotations\n- **Body Parameters**: Complex types or explicit `Body()` annotations\n- **Header/Cookie Parameters**: Parameters with `Header()` or `Cookie()` annotations\n\nSources: [fastapi/dependencies/utils.py348-511](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L348-L511) [fastapi/dependencies/utils.py317-338](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L317-L338)\n\n## Dependency Resolution\n\n### Resolution Algorithm\n\nThe `solve_dependencies` function recursively resolves dependencies using a depth-first approach with caching and lifecycle management.\n\n```\n```\n\nSources: [fastapi/dependencies/utils.py572-695](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L572-L695)\n\n### SolvedDependency Result\n\nThe dependency resolution process returns a `SolvedDependency` object containing all resolved values and metadata:",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 959,
      "character_count": 4418,
      "created_at": "2025-10-16T17:42:18.081315",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "fastapi_fastapi",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "collection_context": "FAST_DOCS/fastapi_fastapi"
    }
  },
  {
    "text": "| Field              | Type              | Purpose                            |\n| ------------------ | ----------------- | ---------------------------------- |\n| `values`           | `Dict[str, Any]`  | Resolved dependency values         |\n| `errors`           | `List[Any]`       | Validation errors encountered      |\n| `background_tasks` | `BackgroundTasks` | Background task manager            |\n| `response`         | `Response`        | Response object for headers/status |\n| `dependency_cache` | `Dict`            | Cache of resolved dependencies     |\n\nSources: [fastapi/dependencies/utils.py563-570](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L563-L570)\n\n## Advanced Features\n\n### Dependency Caching\n\nDependencies are cached by default using a cache key derived from the function and security scopes. Caching prevents redundant computations when the same dependency is used multiple times in a request.\n\n```\n```\n\nCache behavior is controlled by the `use_cache` parameter in `Depends()` and can be disabled for dependencies that should be called multiple times.\n\nSources: [fastapi/dependencies/models.py36-37](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/models.py#L36-L37) [fastapi/dependencies/utils.py631-644](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L631-L644)\n\n### Generator Dependencies\n\nGenerator dependencies support resource management with automatic cleanup using context managers. The system distinguishes between sync and async generators:\n\n- **Sync Generators**: Wrapped with `contextmanager_in_threadpool`\n- **Async Generators**: Used directly as async context managers\n\nSources: [fastapi/dependencies/utils.py553-560](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L553-L560) [fastapi/dependencies/utils.py633-636](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L633-L636)\n\n### Security Dependencies\n\nSecurity dependencies integrate with FastAPI's security system through `SecurityRequirement` objects, which specify security schemes and required scopes.\n\nSources: [fastapi/dependencies/models.py9-11](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/models.py#L9-L11) [fastapi/dependencies/utils.py150-171](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L150-L171)\n\n## Integration with Routing\n\n### Route Handler Integration\n\nThe routing system integrates dependency injection through the `get_request_handler` function, which creates request handlers that automatically resolve dependencies.\n\n```\n```\n\nThe route analysis phase extracts dependency information and creates optimized structures for runtime resolution.\n\nSources: [fastapi/routing.py555-561](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/routing.py#L555-L561) [fastapi/routing.py292-299](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/routing.py#L292-L299) [fastapi/routing.py218-358](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/routing.py#L218-L358)\n\n### Dependency Overrides\n\nThe system supports dependency overrides through the `dependency_overrides_provider`, allowing replacement of dependencies during testing or runtime configuration.\n\nSources: [fastapi/dependencies/utils.py599-613](https://github.com/fastapi/fastapi/blob/3e2dbf91/fastapi/dependencies/utils.py#L599-L613)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [Dependency Injection](#dependency-injection.md)\n- [System Architecture](#system-architecture.md)\n- [Dependency Injection Architecture](#dependency-injection-architecture.md)\n- [Core Components](#core-components.md)\n- [Dependant Model](#dependant-model.md)\n- [Depends Mechanism](#depends-mechanism.md)\n- [Dependency Analysis Process](#dependency-analysis-process.md)\n- [Function Signature Analysis](#function-signature-analysis.md)\n- [Parameter Classification](#parameter-classification.md)\n- [Dependency Resolution](#dependency-resolution.md)\n- [Resolution Algorithm](#resolution-algorithm.md)\n- [SolvedDependency Result](#solveddependency-result.md)\n- [Advanced Features](#advanced-features.md)\n- [Dependency Caching](#dependency-caching.md)\n- [Generator Dependencies](#generator-dependencies.md)\n- [Security Dependencies](#security-dependencies.md)\n- [Integration with Routing](#integration-with-routing.md)\n- [Route Handler Integration](#route-handler-integration.md)\n- [Dependency Overrides](#dependency-overrides.md)",
    "metadata": {
      "chunk_id": 3,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1022,
      "character_count": 4513,
      "created_at": "2025-10-16T17:42:18.088243",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "fastapi_fastapi",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 3,
      "file_relative_path": "FAST_DOCS\\fastapi_fastapi\\_fastapi_fastapi_2.2-dependency-injection.md",
      "collection_context": "FAST_DOCS/fastapi_fastapi"
    }
  }
]