[
  {
    "text": "FastMCP Server Architecture | modelcontextprotocol/python-sdk | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[modelcontextprotocol/python-sdk](https://github.com/modelcontextprotocol/python-sdk \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 27 September 2025 ([146d7e](https://github.com/modelcontextprotocol/python-sdk/commits/146d7efb))\n\n- [Overview](modelcontextprotocol/python-sdk/1-overview.md)\n- [Installation & Dependencies](modelcontextprotocol/python-sdk/1.1-installation-and-dependencies.md)\n- [Key Concepts](modelcontextprotocol/python-sdk/1.2-key-concepts.md)\n- [FastMCP Server Framework](modelcontextprotocol/python-sdk/2-fastmcp-server-framework.md)\n- [FastMCP Server Architecture](modelcontextprotocol/python-sdk/2.1-fastmcp-server-architecture.md)\n- [Tool Management](modelcontextprotocol/python-sdk/2.2-tool-management.md)\n- [Resource & Prompt Management](modelcontextprotocol/python-sdk/2.3-resource-and-prompt-management.md)\n- [Function Introspection & Structured Output](modelcontextprotocol/python-sdk/2.4-function-introspection-and-structured-output.md)\n- [Client Framework](modelcontextprotocol/python-sdk/3-client-framework.md)\n- [ClientSession Core](modelcontextprotocol/python-sdk/3.1-clientsession-core.md)\n- [Client Transports](modelcontextprotocol/python-sdk/3.2-client-transports.md)\n- [Client Authentication](modelcontextprotocol/python-sdk/3.3-client-authentication.md)\n- [Protocol & Message System](modelcontextprotocol/python-sdk/4-protocol-and-message-system.md)\n- [Protocol Types & JSON-RPC](modelcontextprotocol/python-sdk/4.1-protocol-types-and-json-rpc.md)\n- [Session Management](modelcontextprotocol/python-sdk/4.2-session-management.md)\n- [Context & Progress Reporting](modelcontextprotocol/python-sdk/4.3-context-and-progress-reporting.md)\n- [Transport Layer](modelcontextprotocol/python-sdk/5-transport-layer.md)\n- [StreamableHTTP Transport](modelcontextprotocol/python-sdk/5.1-streamablehttp-transport.md)\n- [Server-Sent Events (SSE) Transport](modelcontextprotocol/python-sdk/5.2-server-sent-events-\\(sse\\)-transport.md)\n- [STDIO Transport](modelcontextprotocol/python-sdk/5.3-stdio-transport.md)\n- [Transport Security](modelcontextprotocol/python-sdk/5.4-transport-security.md)\n- [Low-Level Server Implementation](modelcontextprotocol/python-sdk/6-low-level-server-implementation.md)\n- [Low-Level Server Architecture](modelcontextprotocol/python-sdk/6.1-low-level-server-architecture.md)\n- [ServerSession Implementation](modelcontextprotocol/python-sdk/6.2-serversession-implementation.md)\n- [Authentication & Security](modelcontextprotocol/python-sdk/7-authentication-and-security.md)\n- [OAuth 2.0 System](modelcontextprotocol/python-sdk/7.1-oauth-2.0-system.md)\n- [Development Tools & CLI](modelcontextprotocol/python-sdk/8-development-tools-and-cli.md)\n- [MCP CLI Commands](modelcontextprotocol/python-sdk/8.1-mcp-cli-commands.md)\n- [Development Environment](modelcontextprotocol/python-sdk/8.2-development-environment.md)\n- [Claude Desktop Integration](modelcontextprotocol/python-sdk/8.3-claude-desktop-integration.md)\n- [Examples & Tutorials](modelcontextprotocol/python-sdk/9-examples-and-tutorials.md)\n- [Server Examples](modelcontextprotocol/python-sdk/9.1-server-examples.md)\n- [Client Examples](modelcontextprotocol/python-sdk/9.2-client-examples.md)\n\nMenu\n\n# FastMCP Server Architecture\n\nRelevant source files",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 839,
      "character_count": 3491,
      "created_at": "2025-10-16T17:42:19.239671",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "- [src/mcp/server/fastmcp/\\_\\_init\\_\\_.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/__init__.py)\n- [src/mcp/server/fastmcp/server.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py)\n- [src/mcp/server/fastmcp/utilities/func\\_metadata.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/func_metadata.py)\n- [src/mcp/server/fastmcp/utilities/types.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/types.py)\n- [tests/server/fastmcp/test\\_func\\_metadata.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/fastmcp/test_func_metadata.py)\n- [tests/server/fastmcp/test\\_server.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/fastmcp/test_server.py)\n\nThis document explains the internal architecture of the FastMCP server framework, including its core components, managers, function introspection system, and transport integration. FastMCP provides a high-level, decorator-based interface for building MCP servers that automatically handles schema generation, validation, and protocol compliance.\n\nFor information about using FastMCP decorators and APIs, see [Tool Management](modelcontextprotocol/python-sdk/2.2-tool-management.md) and [Resource & Prompt Management](modelcontextprotocol/python-sdk/2.3-resource-and-prompt-management.md). For details about the underlying protocol implementation, see [Low-Level Server Architecture](modelcontextprotocol/python-sdk/6.1-low-level-server-architecture.md).\n\n## Core Architecture Overview\n\nFastMCP implements a layered architecture that wraps the low-level MCP server with higher-level abstractions and automatic introspection capabilities.\n\n```\n```\n\n**Sources:** [src/mcp/server/fastmcp/server.py122-206](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L122-L206) [src/mcp/server/fastmcp/utilities/func\\_metadata.py62-67](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/func_metadata.py#L62-L67)\n\n## FastMCP Main Server Class\n\nThe `FastMCP` class serves as the primary entry point and orchestrator for the entire server framework. It manages settings, coordinates managers, and provides the decorator interface.\n\n### Core Components\n\nThe `FastMCP` class initializes and coordinates several key subsystems:\n\n- **Settings Management**: Uses `Settings` class with environment variable support (prefix `FASTMCP_`)\n- **Manager Coordination**: Initializes `ToolManager`, `ResourceManager`, and `PromptManager`\n- **Protocol Integration**: Wraps the low-level `MCPServer` with enhanced functionality\n- **Transport Apps**: Generates transport-specific applications (stdio, SSE, StreamableHTTP)\n\n```\n```\n\n**Sources:** [src/mcp/server/fastmcp/server.py152-209](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L152-L209) [src/mcp/server/fastmcp/server.py268-280](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L268-L280)\n\n### Decorator Interface\n\nFastMCP provides three primary decorators that automatically handle function registration and introspection:\n\n| Decorator     | Manager           | Purpose                                      |\n| ------------- | ----------------- | -------------------------------------------- |\n| `@tool()`     | `ToolManager`     | Register functions as callable tools         |\n| `@resource()` | `ResourceManager` | Register functions as resources or templates |\n| `@prompt()`   | `PromptManager`   | Register functions as prompt generators      |\n\nEach decorator uses the same underlying pattern: function introspection → manager registration → protocol handler binding.\n\n**Sources:** [src/mcp/server/fastmcp/server.py393-451](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L393-L451) [src/mcp/server/fastmcp/server.py479-578](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L479-L578) [src/mcp/server/fastmcp/server.py588-641](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L588-L641)\n\n## Manager Subsystem Architecture",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1023,
      "character_count": 4400,
      "created_at": "2025-10-16T17:42:19.246356",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "The manager subsystem handles registration, validation, and execution of user-defined functions through a consistent interface pattern.\n\n```\n```\n\n**Sources:** [src/mcp/server/fastmcp/tools.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/tools.py) [src/mcp/server/fastmcp/resources.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/resources.py) [src/mcp/server/fastmcp/prompts.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/prompts.py)\n\n### Function Registration Flow\n\nAll managers follow a consistent registration pattern:\n\n1. **Function Analysis**: Extract signature, docstring, and type annotations\n2. **Schema Generation**: Create Pydantic models for inputs and outputs\n3. **Metadata Creation**: Build `Tool`, `Resource`, or `Prompt` objects\n4. **Storage**: Register in manager's internal dictionary\n5. **Validation**: Check for duplicates and conflicts\n\n**Sources:** [src/mcp/server/fastmcp/utilities/func\\_metadata.py166-284](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/func_metadata.py#L166-L284)\n\n## Function Introspection System\n\nThe function introspection system (`func_metadata`) is the core of FastMCP's automatic schema generation and validation capabilities.\n\n### FuncMetadata Components\n\n```\n```\n\n**Sources:** [src/mcp/server/fastmcp/utilities/func\\_metadata.py62-120](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/func_metadata.py#L62-L120)\n\n### Structured Output Detection\n\nFastMCP automatically determines whether a function should have structured output based on its return type annotation:\n\n| Return Type                          | Output Handling                | Wrapping    |\n| ------------------------------------ | ------------------------------ | ----------- |\n| `BaseModel` subclass                 | Direct schema generation       | No wrapping |\n| Primitive types (`str`, `int`, etc.) | Wrapped in `{\"result\": value}` | Yes         |\n| `dict[str, T]`                       | RootModel generation           | No wrapping |\n| Generic types (`list[T]`, `Union`)   | Wrapped in `{\"result\": value}` | Yes         |\n| Unannotated classes                  | No structured output           | N/A         |\n\n**Sources:** [src/mcp/server/fastmcp/utilities/func\\_metadata.py287-371](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/func_metadata.py#L287-L371)\n\n## Context Injection System\n\nFastMCP provides automatic context injection that gives functions access to request-specific information and MCP capabilities.\n\n```\n```\n\n**Sources:** [src/mcp/server/fastmcp/utilities/context\\_injection.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/context_injection.py) [src/mcp/shared/context.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/shared/context.py)\n\n## Transport Integration Architecture\n\nFastMCP integrates with multiple transport protocols by generating transport-specific ASGI applications that wrap the core MCP server functionality.\n\n```\n```\n\n**Sources:** [src/mcp/server/fastmcp/server.py687-725](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L687-L725) [src/mcp/server/fastmcp/server.py752-884](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L752-L884) [src/mcp/server/fastmcp/server.py885-984](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L885-L984)\n\n### Transport Application Generation\n\nEach transport type requires different ASGI application structure:\n\n1. **stdio**: Direct async function for process communication\n2. **SSE**: Starlette app with GET/POST endpoints and optional authentication\n3. **StreamableHTTP**: Session-managed app with resumable connections\n\nThe `FastMCP` class generates these applications on-demand, configuring middleware, authentication, and routing based on server settings.\n\n**Sources:** [src/mcp/server/fastmcp/server.py752-883](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L752-L883)\n\n## Request Processing Flow\n\nThe following diagram shows how requests flow through the FastMCP architecture from transport to function execution:\n\n```\n```",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1024,
      "character_count": 4481,
      "created_at": "2025-10-16T17:42:19.256368",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "**Sources:** [src/mcp/server/fastmcp/server.py308-312](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/server.py#L308-L312) [src/mcp/server/fastmcp/utilities/func\\_metadata.py68-89](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/fastmcp/utilities/func_metadata.py#L68-L89)\n\nThis architecture enables FastMCP to provide a high-level, decorator-based interface while maintaining full compatibility with the MCP protocol and supporting multiple transport mechanisms.\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [FastMCP Server Architecture](#fastmcp-server-architecture.md)\n- [Core Architecture Overview](#core-architecture-overview.md)\n- [FastMCP Main Server Class](#fastmcp-main-server-class.md)\n- [Core Components](#core-components.md)\n- [Decorator Interface](#decorator-interface.md)\n- [Manager Subsystem Architecture](#manager-subsystem-architecture.md)\n- [Function Registration Flow](#function-registration-flow.md)\n- [Function Introspection System](#function-introspection-system.md)\n- [FuncMetadata Components](#funcmetadata-components.md)\n- [Structured Output Detection](#structured-output-detection.md)\n- [Context Injection System](#context-injection-system.md)\n- [Transport Integration Architecture](#transport-integration-architecture.md)\n- [Transport Application Generation](#transport-application-generation.md)\n- [Request Processing Flow](#request-processing-flow.md)",
    "metadata": {
      "chunk_id": 3,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 336,
      "character_count": 1481,
      "created_at": "2025-10-16T17:42:19.257060",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 3,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_2.1-fastmcp-server-architecture.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  }
]