[
  {
    "text": "Transport Security | modelcontextprotocol/python-sdk | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[modelcontextprotocol/python-sdk](https://github.com/modelcontextprotocol/python-sdk \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 27 September 2025 ([146d7e](https://github.com/modelcontextprotocol/python-sdk/commits/146d7efb))\n\n- [Overview](modelcontextprotocol/python-sdk/1-overview.md)\n- [Installation & Dependencies](modelcontextprotocol/python-sdk/1.1-installation-and-dependencies.md)\n- [Key Concepts](modelcontextprotocol/python-sdk/1.2-key-concepts.md)\n- [FastMCP Server Framework](modelcontextprotocol/python-sdk/2-fastmcp-server-framework.md)\n- [FastMCP Server Architecture](modelcontextprotocol/python-sdk/2.1-fastmcp-server-architecture.md)\n- [Tool Management](modelcontextprotocol/python-sdk/2.2-tool-management.md)\n- [Resource & Prompt Management](modelcontextprotocol/python-sdk/2.3-resource-and-prompt-management.md)\n- [Function Introspection & Structured Output](modelcontextprotocol/python-sdk/2.4-function-introspection-and-structured-output.md)\n- [Client Framework](modelcontextprotocol/python-sdk/3-client-framework.md)\n- [ClientSession Core](modelcontextprotocol/python-sdk/3.1-clientsession-core.md)\n- [Client Transports](modelcontextprotocol/python-sdk/3.2-client-transports.md)\n- [Client Authentication](modelcontextprotocol/python-sdk/3.3-client-authentication.md)\n- [Protocol & Message System](modelcontextprotocol/python-sdk/4-protocol-and-message-system.md)\n- [Protocol Types & JSON-RPC](modelcontextprotocol/python-sdk/4.1-protocol-types-and-json-rpc.md)\n- [Session Management](modelcontextprotocol/python-sdk/4.2-session-management.md)\n- [Context & Progress Reporting](modelcontextprotocol/python-sdk/4.3-context-and-progress-reporting.md)\n- [Transport Layer](modelcontextprotocol/python-sdk/5-transport-layer.md)\n- [StreamableHTTP Transport](modelcontextprotocol/python-sdk/5.1-streamablehttp-transport.md)\n- [Server-Sent Events (SSE) Transport](modelcontextprotocol/python-sdk/5.2-server-sent-events-\\(sse\\)-transport.md)\n- [STDIO Transport](modelcontextprotocol/python-sdk/5.3-stdio-transport.md)\n- [Transport Security](modelcontextprotocol/python-sdk/5.4-transport-security.md)\n- [Low-Level Server Implementation](modelcontextprotocol/python-sdk/6-low-level-server-implementation.md)\n- [Low-Level Server Architecture](modelcontextprotocol/python-sdk/6.1-low-level-server-architecture.md)\n- [ServerSession Implementation](modelcontextprotocol/python-sdk/6.2-serversession-implementation.md)\n- [Authentication & Security](modelcontextprotocol/python-sdk/7-authentication-and-security.md)\n- [OAuth 2.0 System](modelcontextprotocol/python-sdk/7.1-oauth-2.0-system.md)\n- [Development Tools & CLI](modelcontextprotocol/python-sdk/8-development-tools-and-cli.md)\n- [MCP CLI Commands](modelcontextprotocol/python-sdk/8.1-mcp-cli-commands.md)\n- [Development Environment](modelcontextprotocol/python-sdk/8.2-development-environment.md)\n- [Claude Desktop Integration](modelcontextprotocol/python-sdk/8.3-claude-desktop-integration.md)\n- [Examples & Tutorials](modelcontextprotocol/python-sdk/9-examples-and-tutorials.md)\n- [Server Examples](modelcontextprotocol/python-sdk/9.1-server-examples.md)\n- [Client Examples](modelcontextprotocol/python-sdk/9.2-client-examples.md)\n\nMenu\n\n# Transport Security\n\nRelevant source files",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 833,
      "character_count": 3473,
      "created_at": "2025-10-16T17:42:19.593418",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "- [src/mcp/client/auth.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/client/auth.py)\n- [src/mcp/server/auth/handlers/register.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/auth/handlers/register.py)\n- [src/mcp/server/auth/routes.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/auth/routes.py)\n- [src/mcp/server/sse.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/sse.py)\n- [src/mcp/shared/auth.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/shared/auth.py)\n- [tests/client/test\\_auth.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/client/test_auth.py)\n- [tests/shared/test\\_auth.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/shared/test_auth.py)\n- [tests/shared/test\\_sse.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/shared/test_sse.py)\n\nThis document covers the security features implemented for MCP transport layers, focusing on DNS rebinding protection and request validation middleware. The security system provides configurable protection against malicious cross-origin requests targeting locally-hosted MCP servers.\n\nFor information about specific transport implementations, see [StreamableHTTP Transport](modelcontextprotocol/python-sdk/5.1-streamablehttp-transport.md), [SSE Transport](modelcontextprotocol/python-sdk/5.2-server-sent-events-\\(sse\\)-transport.md), and [WebSocket Transport](modelcontextprotocol/python-sdk/5.4-transport-security.md). For authentication mechanisms, see [Authentication & Security](modelcontextprotocol/python-sdk/7-authentication-and-security.md).\n\n## Security Architecture Overview\n\nThe transport security system implements a middleware-based architecture that validates incoming HTTP requests before they reach the MCP protocol handlers. The system is designed to prevent DNS rebinding attacks while maintaining compatibility with legitimate client connections.\n\n```\n```\n\nSources: [src/mcp/server/transport\\_security.py37-128](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L37-L128) [src/mcp/server/streamable\\_http\\_manager.py24-68](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/streamable_http_manager.py#L24-L68)\n\n## DNS Rebinding Protection\n\nDNS rebinding attacks occur when malicious websites trick browsers into making requests to local servers using specially crafted DNS responses. The MCP security system prevents these attacks by validating request headers that browsers automatically include.\n\n### Threat Model\n\n| Attack Vector         | Validation Method         | HTTP Status | Error Message                 |\n| --------------------- | ------------------------- | ----------- | ----------------------------- |\n| Malicious Host header | Host whitelist validation | 421         | \"Invalid Host header\"         |\n| Cross-origin requests | Origin header validation  | 400         | \"Invalid Origin header\"       |\n| Wrong content type    | Content-Type validation   | 400         | \"Invalid Content-Type header\" |\n\n```\n```\n\nSources: [src/mcp/server/transport\\_security.py45-66](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L45-L66) [tests/server/test\\_streamable\\_http\\_security.py110-136](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_streamable_http_security.py#L110-L136)\n\n## Configuration Settings\n\nThe `TransportSecuritySettings` class provides flexible configuration for security features:\n\n### Basic Configuration\n\n```\n```\n\n### Wildcard Port Patterns\n\nThe system supports wildcard port patterns for development environments:\n\n| Pattern                | Matches               | Example                            |\n| ---------------------- | --------------------- | ---------------------------------- |\n| `\"localhost:*\"`        | Any port on localhost | `localhost:3000`, `localhost:8080` |\n| `\"127.0.0.1:*\"`        | Any port on 127.0.0.1 | `127.0.0.1:5000`, `127.0.0.1:9999` |\n| `\"http://localhost:*\"` | Any port in origins   | `http://localhost:3000`            |\n\n```\n```",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 947,
      "character_count": 4274,
      "created_at": "2025-10-16T17:42:19.600173",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "Sources: [src/mcp/server/transport\\_security.py12-35](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L12-L35) [src/mcp/server/transport\\_security.py56-63](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L56-L63) [tests/server/test\\_sse\\_security.py226-256](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_sse_security.py#L226-L256)\n\n## Security Middleware Implementation\n\nThe `TransportSecurityMiddleware` class implements the core validation logic:\n\n### Validation Methods\n\n| Method                     | Purpose                                 | Returns    |\n| -------------------------- | --------------------------------------- | ---------- |\n| `_validate_host()`         | Validates Host header against whitelist | `bool`     |\n| `_validate_origin()`       | Validates Origin header (optional)      | `bool`     |\n| `_validate_content_type()` | Ensures JSON content type for POST      | `bool`     |\n| `validate_request()`       | Main validation entry point             | \\`Response |\n\n### Validation Flow\n\n```\n```\n\nSources: [src/mcp/server/transport\\_security.py102-128](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L102-L128) [src/mcp/server/transport\\_security.py89-101](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L89-L101)\n\n## Transport Integration\n\nSecurity middleware integrates with multiple transport types through a common pattern:\n\n### StreamableHTTP Integration\n\nThe `StreamableHTTPSessionManager` accepts security settings and passes them to transport instances:\n\n```\n```\n\n### SSE Integration\n\nThe `SseServerTransport` similarly integrates security validation:\n\n| Transport Type | Security Integration Point                  | Error Handling                    |\n| -------------- | ------------------------------------------- | --------------------------------- |\n| StreamableHTTP | `StreamableHTTPServerTransport` constructor | Middleware returns error response |\n| SSE            | `SseServerTransport` constructor            | Validation in `connect_sse()`     |\n| WebSocket      | Not implemented                             | N/A                               |\n| STDIO          | Not applicable                              | Local process communication       |\n\nSources: [src/mcp/server/streamable\\_http\\_manager.py62-68](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/streamable_http_manager.py#L62-L68) [src/mcp/server/streamable\\_http\\_manager.py224-229](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/streamable_http_manager.py#L224-L229) [tests/server/test\\_sse\\_security.py45-58](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_sse_security.py#L45-L58)\n\n## Default Security Behavior\n\nThe security system uses conservative defaults to maintain backward compatibility:\n\n### Default Settings\n\n| Setting                           | Default Value                             | Rationale                     |\n| --------------------------------- | ----------------------------------------- | ----------------------------- |\n| `enable_dns_rebinding_protection` | `True` in settings, `False` in middleware | Backwards compatibility       |\n| `allowed_hosts`                   | `[]` (empty list)                         | Must be explicitly configured |\n| `allowed_origins`                 | `[]` (empty list)                         | Must be explicitly configured |\n\n### Backward Compatibility\n\n```\n```\n\nSources: [src/mcp/server/transport\\_security.py40-43](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L40-L43) [src/mcp/server/transport\\_security.py114-115](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/transport_security.py#L114-L115)\n\n## Testing and Validation\n\nThe security system includes comprehensive tests covering various attack scenarios and configuration options:\n\n### Test Coverage\n\n| Test Category           | File                               | Key Test Cases                               |\n| ----------------------- | ---------------------------------- | -------------------------------------------- |\n| StreamableHTTP Security | `test_streamable_http_security.py` | Host/Origin validation, Content-Type checks  |\n| SSE Security            | `test_sse_security.py`             | GET/POST validation, wildcard patterns       |\n| Integration             | Both files                         | Real server processes, multiprocessing tests |\n\n### Security Test Scenarios\n\n```\n```",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 963,
      "character_count": 4770,
      "created_at": "2025-10-16T17:42:19.609073",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "Sources: [tests/server/test\\_streamable\\_http\\_security.py85-294](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_streamable_http_security.py#L85-L294) [tests/server/test\\_sse\\_security.py78-294](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_sse_security.py#L78-L294)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [Transport Security](#transport-security.md)\n- [Security Architecture Overview](#security-architecture-overview.md)\n- [DNS Rebinding Protection](#dns-rebinding-protection.md)\n- [Threat Model](#threat-model.md)\n- [Configuration Settings](#configuration-settings.md)\n- [Basic Configuration](#basic-configuration.md)\n- [Wildcard Port Patterns](#wildcard-port-patterns.md)\n- [Security Middleware Implementation](#security-middleware-implementation.md)\n- [Validation Methods](#validation-methods.md)\n- [Validation Flow](#validation-flow.md)\n- [Transport Integration](#transport-integration.md)\n- [StreamableHTTP Integration](#streamablehttp-integration.md)\n- [SSE Integration](#sse-integration.md)\n- [Default Security Behavior](#default-security-behavior.md)\n- [Default Settings](#default-settings.md)\n- [Backward Compatibility](#backward-compatibility.md)\n- [Testing and Validation](#testing-and-validation.md)\n- [Test Coverage](#test-coverage.md)\n- [Security Test Scenarios](#security-test-scenarios.md)",
    "metadata": {
      "chunk_id": 3,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 337,
      "character_count": 1413,
      "created_at": "2025-10-16T17:42:19.609607",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 3,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_5.4-transport-security.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  }
]