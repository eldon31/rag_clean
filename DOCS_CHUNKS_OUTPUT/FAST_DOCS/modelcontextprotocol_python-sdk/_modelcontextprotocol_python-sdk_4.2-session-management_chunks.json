[
  {
    "text": "Session Management | modelcontextprotocol/python-sdk | DeepWiki\n\n[Index your code with Devin](private-repo.md)\n\n[DeepWiki](https://deepwiki.com)\n\n[DeepWiki](.md)\n\n[modelcontextprotocol/python-sdk](https://github.com/modelcontextprotocol/python-sdk \"Open repository\")\n\n[Index your code with](private-repo.md)\n\n[Devin](private-repo.md)\n\nShare\n\nLast indexed: 27 September 2025 ([146d7e](https://github.com/modelcontextprotocol/python-sdk/commits/146d7efb))\n\n- [Overview](modelcontextprotocol/python-sdk/1-overview.md)\n- [Installation & Dependencies](modelcontextprotocol/python-sdk/1.1-installation-and-dependencies.md)\n- [Key Concepts](modelcontextprotocol/python-sdk/1.2-key-concepts.md)\n- [FastMCP Server Framework](modelcontextprotocol/python-sdk/2-fastmcp-server-framework.md)\n- [FastMCP Server Architecture](modelcontextprotocol/python-sdk/2.1-fastmcp-server-architecture.md)\n- [Tool Management](modelcontextprotocol/python-sdk/2.2-tool-management.md)\n- [Resource & Prompt Management](modelcontextprotocol/python-sdk/2.3-resource-and-prompt-management.md)\n- [Function Introspection & Structured Output](modelcontextprotocol/python-sdk/2.4-function-introspection-and-structured-output.md)\n- [Client Framework](modelcontextprotocol/python-sdk/3-client-framework.md)\n- [ClientSession Core](modelcontextprotocol/python-sdk/3.1-clientsession-core.md)\n- [Client Transports](modelcontextprotocol/python-sdk/3.2-client-transports.md)\n- [Client Authentication](modelcontextprotocol/python-sdk/3.3-client-authentication.md)\n- [Protocol & Message System](modelcontextprotocol/python-sdk/4-protocol-and-message-system.md)\n- [Protocol Types & JSON-RPC](modelcontextprotocol/python-sdk/4.1-protocol-types-and-json-rpc.md)\n- [Session Management](modelcontextprotocol/python-sdk/4.2-session-management.md)\n- [Context & Progress Reporting](modelcontextprotocol/python-sdk/4.3-context-and-progress-reporting.md)\n- [Transport Layer](modelcontextprotocol/python-sdk/5-transport-layer.md)\n- [StreamableHTTP Transport](modelcontextprotocol/python-sdk/5.1-streamablehttp-transport.md)\n- [Server-Sent Events (SSE) Transport](modelcontextprotocol/python-sdk/5.2-server-sent-events-\\(sse\\)-transport.md)\n- [STDIO Transport](modelcontextprotocol/python-sdk/5.3-stdio-transport.md)\n- [Transport Security](modelcontextprotocol/python-sdk/5.4-transport-security.md)\n- [Low-Level Server Implementation](modelcontextprotocol/python-sdk/6-low-level-server-implementation.md)\n- [Low-Level Server Architecture](modelcontextprotocol/python-sdk/6.1-low-level-server-architecture.md)\n- [ServerSession Implementation](modelcontextprotocol/python-sdk/6.2-serversession-implementation.md)\n- [Authentication & Security](modelcontextprotocol/python-sdk/7-authentication-and-security.md)\n- [OAuth 2.0 System](modelcontextprotocol/python-sdk/7.1-oauth-2.0-system.md)\n- [Development Tools & CLI](modelcontextprotocol/python-sdk/8-development-tools-and-cli.md)\n- [MCP CLI Commands](modelcontextprotocol/python-sdk/8.1-mcp-cli-commands.md)\n- [Development Environment](modelcontextprotocol/python-sdk/8.2-development-environment.md)\n- [Claude Desktop Integration](modelcontextprotocol/python-sdk/8.3-claude-desktop-integration.md)\n- [Examples & Tutorials](modelcontextprotocol/python-sdk/9-examples-and-tutorials.md)\n- [Server Examples](modelcontextprotocol/python-sdk/9.1-server-examples.md)\n- [Client Examples](modelcontextprotocol/python-sdk/9.2-client-examples.md)\n\nMenu\n\n# Session Management\n\nRelevant source files",
    "metadata": {
      "chunk_id": 0,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_4.2-session-management.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 833,
      "character_count": 3473,
      "created_at": "2025-10-16T17:42:19.456493",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 0,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_4.2-session-management.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "- [src/mcp/client/\\_\\_main\\_\\_.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/client/__main__.py)\n- [src/mcp/client/session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/client/session.py)\n- [src/mcp/server/models.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/models.py)\n- [src/mcp/server/session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py)\n- [src/mcp/shared/memory.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/shared/memory.py)\n- [src/mcp/shared/session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/shared/session.py)\n- [tests/client/test\\_logging\\_callback.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/client/test_logging_callback.py)\n- [tests/client/test\\_session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/client/test_session.py)\n- [tests/server/test\\_session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_session.py)\n\nSession management in the MCP Python SDK provides the foundational infrastructure for maintaining communication state between clients and servers. This system handles message correlation, request/response tracking, protocol initialization, and connection lifecycle management. For specific client-side session usage, see [ClientSession Core](modelcontextprotocol/python-sdk/3.1-clientsession-core.md). For protocol message types and JSON-RPC implementation details, see [Protocol Types & JSON-RPC](modelcontextprotocol/python-sdk/4.1-protocol-types-and-json-rpc.md).\n\n## BaseSession Architecture\n\nThe `BaseSession` class forms the core of MCP's session management system, providing message correlation, stream management, and request/response tracking for both client and server implementations.\n\n### Message Correlation System\n\n```\n```\n\nThe BaseSession maintains request correlation through a sophisticated tracking system that maps request IDs to response streams, ensuring that responses are delivered to the correct waiting coroutines even in highly concurrent scenarios.\n\nSources: [src/mcp/shared/session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/shared/session.py) [tests/shared/test\\_session.py36-46](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/shared/test_session.py#L36-L46) [tests/client/test\\_resource\\_cleanup.py12-61](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/client/test_resource_cleanup.py#L12-L61)\n\n### Stream Management and Cleanup\n\nBaseSession manages memory object streams for bidirectional communication, with automatic cleanup to prevent resource leaks:\n\n```\n```\n\nThe session ensures proper stream cleanup even when exceptions occur during request transmission, preventing memory leaks in long-running connections.\n\nSources: [tests/client/test\\_resource\\_cleanup.py13-56](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/client/test_resource_cleanup.py#L13-L56) [src/mcp/shared/session.py](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/shared/session.py)\n\n## ServerSession Implementation\n\nThe `ServerSession` class extends BaseSession to provide server-specific functionality, including initialization state management, client capability checking, and various notification methods.\n\n### Initialization State Flow\n\n```\n```\n\nThe ServerSession enforces a strict initialization protocol where most requests are blocked until the initialization handshake completes, with ping requests being the only exception.\n\nSources: [src/mcp/server/session.py58-62](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py#L58-L62) [src/mcp/server/session.py167-179](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py#L167-L179) [tests/server/test\\_session.py219-283](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_session.py#L219-L283)\n\n### Client Capability Checking\n\nServerSession provides a comprehensive capability checking system that allows servers to adapt their behavior based on client capabilities:",
    "metadata": {
      "chunk_id": 1,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_4.2-session-management.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 936,
      "character_count": 4304,
      "created_at": "2025-10-16T17:42:19.462745",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 1,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_4.2-session-management.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  },
  {
    "text": "| Capability Type | Check Method                | Purpose                      |\n| --------------- | --------------------------- | ---------------------------- |\n| `roots`         | `check_client_capability()` | File system root access      |\n| `sampling`      | `check_client_capability()` | LLM sampling support         |\n| `elicitation`   | `check_client_capability()` | User input elicitation       |\n| `experimental`  | `check_client_capability()` | Custom experimental features |\n\n```\n```\n\nSources: [src/mcp/server/session.py105-136](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py#L105-L136) [src/mcp/server/session.py8-34](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py#L8-L34)\n\n## Session Communication Methods\n\nServerSession provides specialized methods for different types of server-to-client communication:\n\n### Notification Methods\n\n| Method                         | Purpose                | Message Type                      |\n| ------------------------------ | ---------------------- | --------------------------------- |\n| `send_log_message()`           | Server logging         | `LoggingMessageNotification`      |\n| `send_resource_updated()`      | Resource change events | `ResourceUpdatedNotification`     |\n| `send_progress_notification()` | Operation progress     | `ProgressNotification`            |\n| `send_resource_list_changed()` | Resource list updates  | `ResourceListChangedNotification` |\n| `send_tool_list_changed()`     | Tool list updates      | `ToolListChangedNotification`     |\n| `send_prompt_list_changed()`   | Prompt list updates    | `PromptListChangedNotification`   |\n\n### Request Methods\n\nServerSession can also send requests to clients for advanced capabilities:\n\n| Method             | Purpose           | Result Type           |\n| ------------------ | ----------------- | --------------------- |\n| `create_message()` | LLM sampling      | `CreateMessageResult` |\n| `list_roots()`     | File system roots | `ListRootsResult`     |\n| `elicit()`         | User input        | `ElicitResult`        |\n| `send_ping()`      | Connection health | `EmptyResult`         |\n\nSources: [src/mcp/server/session.py181-323](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py#L181-L323)\n\n## Request Cancellation and Error Handling\n\nThe session management system provides robust cancellation and error handling capabilities:\n\n```\n```\n\nThe cancellation system ensures that servers remain functional after request cancellations and that pending requests are properly cleaned up when connections are lost.\n\nSources: [tests/shared/test\\_session.py48-123](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/shared/test_session.py#L48-L123) [tests/server/test\\_cancel\\_handling.py25-111](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_cancel_handling.py#L25-L111) [tests/shared/test\\_session.py125-171](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/shared/test_session.py#L125-L171)\n\n## Integration with Server Framework\n\nServerSession integrates closely with the broader MCP server framework:\n\n```\n```\n\nServerSession serves as the communication bridge between the protocol layer and application logic, handling the low-level details of message transmission while providing a clean interface for server implementations.\n\nSources: [src/mcp/server/session.py83-100](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/session.py#L83-L100) [src/mcp/server/models.py13-18](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/src/mcp/server/models.py#L13-L18) [tests/server/test\\_session.py32-81](https://github.com/modelcontextprotocol/python-sdk/blob/146d7efb/tests/server/test_session.py#L32-L81)\n\nDismiss\n\nRefresh this wiki\n\nEnter email to refresh\n\n### On this page\n\n- [Session Management](#session-management.md)\n- [BaseSession Architecture](#basesession-architecture.md)\n- [Message Correlation System](#message-correlation-system.md)\n- [Stream Management and Cleanup](#stream-management-and-cleanup.md)\n- [ServerSession Implementation](#serversession-implementation.md)\n- [Initialization State Flow](#initialization-state-flow.md)\n- [Client Capability Checking](#client-capability-checking.md)\n- [Session Communication Methods](#session-communication-methods.md)\n- [Notification Methods](#notification-methods.md)\n- [Request Methods](#request-methods.md)\n- [Request Cancellation and Error Handling](#request-cancellation-and-error-handling.md)\n- [Integration with Server Framework](#integration-with-server-framework.md)",
    "metadata": {
      "chunk_id": 2,
      "source_file": "C:\\Users\\raze0\\Documents\\LLM_KNOWLEDGE_CREATOR\\RAG\\RAG_CLEAN\\Docs\\FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_4.2-session-management.md",
      "input_type": "fast_docs",
      "chunking_strategy": "api_documentation",
      "token_count": 1004,
      "character_count": 4697,
      "created_at": "2025-10-16T17:42:19.469150",
      "parent_context": null,
      "semantic_type": "fast_docs",
      "collection_name": "FAST_DOCS",
      "subfolder_name": "modelcontextprotocol_python-sdk",
      "collection_strategy": "api_documentation",
      "chunk_index_in_file": 2,
      "file_relative_path": "FAST_DOCS\\modelcontextprotocol_python-sdk\\_modelcontextprotocol_python-sdk_4.2-session-management.md",
      "collection_context": "FAST_DOCS/modelcontextprotocol_python-sdk"
    }
  }
]