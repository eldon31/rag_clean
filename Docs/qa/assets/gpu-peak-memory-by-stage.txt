╔════════════════════════════════════════════════════════════════════════════════╗
║ Grafana Dashboard: RAG Pipeline Performance Baseline - GPU Peak Memory        ║
║ Panel: GPU VRAM Usage by Pipeline Stage (Stacked Area Chart)                  ║
║ Time Range: 2025-10-25 00:00:00 - 2025-10-25 02:30:00                         ║
╚════════════════════════════════════════════════════════════════════════════════╝

Query: max_over_time(rag_gpu_peak_bytes{stage=~"dense|rerank|sparse"}[5m])
Device: cuda:0 (NVIDIA RTX 3090 - 24GB total)

 Memory (GB)
   24.0 ┤                                                        ── Hard Limit
        │
   20.0 ┤
        │
   16.0 ┤
        │
   12.0 ┤- - - - - - - - - - - - - - - - - - - - - - - - - - - - - CRIT threshold
        │
   11.5 ┤─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ WARN threshold
        │
   10.0 ┤
        │                    ╔════════════════════════╗
    9.0 ┤                    ║       SPARSE          ║ 1.8 GB peak
        │                    ║    ┌──────────┐       ║
    8.0 ┤                    ║    │          │       ║
        │                    ╠════╪══════════╪═══════╣
    7.0 ┤                    ║    │ RERANK   │       ║ 2.1 GB peak
        │                    ║    │┌────────┐│       ║
    6.0 ┤                    ║    ││        ││       ║
        │                    ║    ││ DENSE  ││       ║ 6.3 GB peak
    5.0 ┤                    ║    ││        ││       ║
        │                    ║    ││┌──────┐││       ║
    4.0 ┤                    ║    │││      │││       ║
        │                    ║    │││      │││       ║
    3.0 ┤                    ║    │││      │││       ║
        │                    ║    │││      │││       ║
    2.0 ┤                    ║    │││      │││       ║
        │                    ║    │││      │││       ║
    1.0 ┤                    ║    │││      │││       ║
        │                    ║    │││      │││       ║
    0.0 ┤────────────────────╨────┴┴┴──────┴┴┴───────────────────────────> Time
        00:00      00:30      01:00    01:30      02:00      02:30

╔═══════════════════════════════════════════════════════════════════╗
║ GPU Memory Usage Summary (NVIDIA RTX 3090, 24GB total)           ║
╠═══════════════════════════════════════════════════════════════════╣
║ STAGE              │ PEAK VRAM │ AVG VRAM │ % OF TOTAL │ DEVICE  ║
║────────────────────┼───────────┼──────────┼────────────┼─────────║
║ Dense (ensemble)   │ 6.3 GB    │ 5.8 GB   │ 26.3%      │ cuda:0  ║
║ Rerank (jina-v2)   │ 2.1 GB    │ 1.9 GB   │ 8.8%       │ cuda:0  ║
║ Sparse (splade)    │ 1.8 GB    │ 1.6 GB   │ 7.5%       │ cuda:0  ║
║────────────────────┼───────────┼──────────┼────────────┼─────────║
║ COMBINED PEAK      │ 8.4 GB    │ 7.9 GB   │ 35.0%      │         ║
║────────────────────┼───────────┼──────────┼────────────┼─────────║
║ Available Headroom │ 15.6 GB   │          │ 65.0%      │         ║
╚═══════════════════════════════════════════════════════════════════╝

Alert Thresholds:
  ⚠️  WARNING:  11.5 GB (48% of total) - Never triggered (0/50 runs)
  🔴 CRITICAL: 12.0 GB (50% of total) - Never triggered (0/50 runs)

Exclusive Ensemble Mode: ✅ ENABLED
  - Models load sequentially (one at a time)
  - Memory released between models
  - No concurrent GPU contention

Test Corpus: Docling documentation (3,096 chunks, 42 files)
Runs Sampled: 50 executions over 2.5 hour period
Data Source: Prometheus (http://localhost:9090)
Panel ID: rag-gpu-memory-by-stage-002
Refresh: 10s
