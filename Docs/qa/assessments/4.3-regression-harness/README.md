# Regression Harness Baseline

This folder captures deterministic regression evidence for Story 4.3. The
baseline artifacts are generated by running `pytest -m regression_harness`
against the Docling mini corpus (`tests/data/regression/docling-mini/`).

## Refresh Procedure

1. Ensure environment variables mirror CI defaults:
   - `REGRESSION_HARNESS_OUTPUT_DIR` set to the target evidence folder.
   - `REGRESSION_HARNESS_TIMESTAMP` set to the desired run stamp (YYYYMMDD).
2. Execute `pytest -m regression_harness -v --tb=short` from the repository
   root. The fixtures will emit timestamped CLI logs, processing summaries, and
   qdrant JSONL payloads for each scenario.
3. Run the metrics verification helper documented in `MANIFEST.md` (mirrors the
   CI consolidation step) to ensure latency, GPU peak, and fallback counters stay
   within the 10% guardrail captured in `metrics/default-on_metrics_baseline.json`.

## Rollback Guidance

- Latency variance >10%: revert to prior embedder build and re-run dense-only
  smoke tests.
- GPU peak variance >10%: re-enable soft-limit guardrails and investigate model
  hydration changes.
- Fallback counters increase: inspect rerank/sparse logs for new failure modes.

Record findings in `metrics/notes.md` (optional) and update `MANIFEST.md` with
any newly captured evidence.
